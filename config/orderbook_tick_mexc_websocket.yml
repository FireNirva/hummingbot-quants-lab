# MEXC WebSocket Tick-Level Orderbook Collection Configuration
#
# ğŸ“Š MEXC WebSocket + Protobuf æ¨¡å¼
#
# ç‰¹ç‚¹ï¼š
# - WebSocket å®æ—¶æµ (100ms å»¶è¿Ÿ)
# - Protocol Buffers äºŒè¿›åˆ¶æ ¼å¼
# - å¢é‡æ›´æ–° (diff mode)
# - è¶…é«˜é¢‘ç‡æ•°æ®é‡‡é›†
#
# æŠ€æœ¯å¯¹æ¯”ï¼š
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Exchange     â”‚ Protocol   â”‚ Format   â”‚ Frequency  â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ Gate.io      â”‚ WebSocket  â”‚ JSON     â”‚ Real-time  â”‚
# â”‚ MEXC         â”‚ WebSocket  â”‚ Protobuf â”‚ Real-time  â”‚
# â”‚ MEXC (REST)  â”‚ HTTP       â”‚ JSON     â”‚ 10s        â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# ä½¿ç”¨æ–¹æ³•ï¼š
#   python cli.py run-tasks --config config/orderbook_tick_mexc_websocket.yml
#
# æ•°æ®å­˜å‚¨ä½ç½®ï¼š
#   app/data/raw/orderbook_ticks/mexc_{SYMBOL}_{YYYYMMDD}/
#
# å‰ç½®è¦æ±‚ï¼š
#   - protobuf å·²å®‰è£… (conda install protobuf)
#   - proto æ–‡ä»¶å·²ç¼–è¯‘ (core/data_sources/mexc_proto/)

tasks:
  orderbook_tick_mexc:
    enabled: true
    task_class: app.tasks.data_collection.orderbook_tick_collector.OrderBookTickCollector
    
    schedule:
      # Long-running streaming task (WebSocket é•¿è¿æ¥)
      # WebSocket maintains persistent connection inside execute()
      # Set long frequency so task runs for extended periods
      type: frequency
      frequency_hours: 24  # Task runs for 24 hours before restart
      timezone: UTC
    
    # é‡è¯•é…ç½®
    # Task will auto-restart on connection failures
    max_retries: 999
    retry_delay_seconds: 30
    
    # ä»»åŠ¡ç‰¹å®šé…ç½®
    config:
      # äº¤æ˜“æ‰€é€‰æ‹©
      connector_name: "mexc"
      
      # æŒ‡å®šè¦é‡‡é›†çš„äº¤æ˜“å¯¹
      # MEXC ä½¿ç”¨æ— è¿å­—ç¬¦æ ¼å¼ï¼šAUKIUSDT (ä¸æ˜¯ AUKI-USDT)
      trading_pairs:
        - "AUKIUSDT"
        - "SERVUSDT"
        - "IRONUSDT"
        - "VIRTUALUSDT"
        - "LMTSUSDT"
        - "BNKRUSDT"
      
      # å†™å…¥é…ç½®
      # ğŸ’¡ tick æ•°æ®é‡å¤§ï¼Œä½¿ç”¨è¾ƒå¤§ç¼“å†²åŒºå’Œè¾ƒçŸ­åˆ·æ–°é—´éš”
      buffer_size: 1000        # æ¯1000æ¡tickå†™å…¥ä¸€æ¬¡
      flush_interval: 60       # æˆ–æ¯60ç§’å¼ºåˆ¶åˆ·æ–°
      
      # æ•°æ®å­˜å‚¨è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
      output_dir: "app/data/raw/orderbook_ticks"
      
      # Sequence gapç›‘æ§
      # MEXC WebSocketåœ¨æ´»è·ƒäº¤æ˜“å¯¹ä¸Šå¯èƒ½æœ‰å°çš„gapï¼ˆæœåŠ¡å™¨ç«¯åˆå¹¶ï¼‰
      # åªå¯¹å¤§gapå‘å‡ºè­¦å‘Š
      gap_warning_threshold: 50  # åªè­¦å‘Šå¤§äº50çš„gap
    
    # ä»»åŠ¡æ ‡ç­¾
    tags:
      - data_collection
      - orderbook_tick
      - mexc
      - websocket_mode
      - protobuf
      - real_time
      - base_ecosystem

# ğŸ“ ä½¿ç”¨è¯´æ˜
#
# 1. å¯åŠ¨é‡‡é›†ï¼š
#    python cli.py run-tasks --config config/orderbook_tick_mexc_websocket.yml
#
# 2. æŸ¥çœ‹æ•°æ®ï¼š
#    import pyarrow.parquet as pq
#    df = pq.read_table('app/data/raw/orderbook_ticks/mexc_AUKIUSDT_20251119').to_pandas()
#
# 3. æ•°æ®æ ¼å¼ï¼š
#    - Long-tableï¼šæ¯è¡Œä¸€ä¸ªä»·æ ¼levelçš„å˜åŒ–
#    - snapshot_flag: False = diffæ›´æ–°
#    - update_id: MEXCçš„versionå·
#
# 4. æ€§èƒ½ä¼˜åŒ–ï¼š
#    - å¤šæ–‡ä»¶è¿½åŠ æ¨¡å¼é¿å…rewrite
#    - æ™ºèƒ½ç¼“å†²å‡å°‘I/O
#    - ProtobufäºŒè¿›åˆ¶æ ¼å¼æ›´é«˜æ•ˆ
#
# 5. ç›‘æ§æŒ‡æ ‡ï¼š
#    - è¿æ¥çŠ¶æ€
#    - æ¥æ”¶é€Ÿç‡
#    - Sequence gaps
#    - ç¼“å†²åŒºä½¿ç”¨ç‡

