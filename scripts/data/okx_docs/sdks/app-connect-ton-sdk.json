{
  "title": "SDK | Ton | 连接App或Mini钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "SDK\n#\n如果您之前使用过Ton Connect，可以继续使用此文档连接，可以减少开发成本。\n如果您之前使用过OKX Connect，可以跳转去使用ProviderSDK进行连接，可以减少开发成本，并且可以支持多个网络同时请求。\nProviderSDK\n安装SDK\n#\n可以通过cdn或者npm安装SDK\n通过cdn安装\n将如下代码添加到HTML文件中，也可以将latest替换为特定的版本号例如1.6.1。\n<script src=\"https://unpkg.com/@okxconnect/tonsdk@latest/dist/okxconnect_tonsdk.min.js\"></script>\n引入后，OKXTonConnectSDK会作为全局对象可以直接引用\n<script> const connector = new OKXTonConnectSDK.OKXTonConnect(); </script>\n通过npm安装\nnpm install @okxconnect/tonsdk\n初始化\n#\n连接钱包之前，需要先创建一个对象，用于后续连接钱包、发送交易等操作\nnew OKXTonConnect({metaData: {name, icon}})\n请求参数\nmetaData - object\nname - string: 应用名称，不会作为唯一表示\nicon - string: 应用图标的 URL。必须是 PNG、ICO 等格式，不支持 SVG 图标。最好传递指向 180x180px PNG 图标的 url。\n返回值\nokxTonConnect - OKXTonConnect\n示例\nimport\n{\nOKXTonConnect\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nconst\nokxTonConnect\n=\nnew\nOKXTonConnect\n(\n{\nmetaData\n:\n{\nname\n:\n\"application name\"\n,\nicon\n:\n\"application icon url\"\n}\n}\n)\n;\n连接钱包\n#\n连接钱包去获取钱包地址，作为标识符和用于签名交易的必要参数\nconnect(request): Promise<string>;\n请求参数\nrequest - object (可选)\ntonProof - string (可选) : 签名信息\nredirect - string (可选) : 处理完钱包事件，返回的app 所需要的deeplink，例如：在 Telegram 环境下，此字段需要传递 Telegram\n的deeplink，当在钱包签名完成后，OKX App 会通过此deeplink 打开 Telegram 程序，非Telegram环境建议不设置\nopenUniversalLink - boolean (可选) : 连接钱包时,是否通过 Universal link 唤起 OKX App 客户端；设置为 true\n的情况下，用户发起连接钱包时，会拉起 OKX App 客户端，并弹出确认页面，如果手机未安装 OKX App 客户端，跳转到下载页\n返回值\nPromise - string: PC 网页端可以根据该字段生成二维码，OKX App 客户端在 web3 中扫描生成的二维码，连接 DApp\n建议\n在手机浏览器或者手机 Telegram 环境下设置 openUniversalLink 为 true\n在 PC 浏览器环境下设置 openUniversalLink 为 false，并根据返回的 universalLink 生成二维码，可以用 OKX App 客户端扫码连接，在连接成功后，取消二维码弹窗\n示例\nimport\n{\nOKXConnectError\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\ntry\n{\nokxTonConnect\n.\nconnect\n(\n{\ntonProof\n:\n\"signmessage\"\n,\nredirect\n:\n\"tg://resolve\"\n,\nopenUniversalLink\n:\ntrue\n}\n)\n}\ncatch\n(\nerror\n)\n{\nif\n(\nerror\ninstanceof\nOKXConnectError\n)\n{\nif\n(\nerror\n.\ncode\n===\nOKX_CONNECT_ERROR_CODES\n.\nUSER_REJECTS_ERROR\n)\n{\nalert\n(\n'User reject'\n)\n;\n}\nelse\nif\n(\nerror\n.\ncode\n===\nOKX_CONNECT_ERROR_CODES\n.\nALREADY_CONNECTED_ERROR\n)\n{\nalert\n(\n'Already connected'\n)\n;\n}\nelse\n{\nalert\n(\n'Unknown error happened'\n)\n;\n}\n}\nelse\n{\nalert\n(\n'Unknown error happened'\n)\n;\n}\n}\n恢复连接\n#\n如果用户之前连接过钱包，在再次进入或页面刷新时可调用此方法，用来恢复之前的连接状态\nrestoreConnection(): Promise<void>\n请求参数\n无\n返回值\n无\n示例\nokxTonConnect\n.\nrestoreConnection\n(\n)\n断开连接\n#\n断开已连接钱包，并删除当前会话，如果要切换连接钱包，请先断开当前钱包\n示例\nimport\n{\nOKX_CONNECT_ERROR_CODES\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\ntry\n{\nawait\nokxTonConnect\n.\ndisconnect\n(\n)\n}\ncatch\n(\nerror\n)\n{\nif\n(\nerror\ninstanceof\nOKXConnectError\n)\n{\nswitch\n(\nerror\n.\ncode\n)\n{\ncase\nOKX_CONNECT_ERROR_CODES\n.\nNOT_CONNECTED_ERROR\n:\nalert\n(\n'Not connected'\n)\n;\nbreak\n;\ndefault\n:\nalert\n(\n'Unknown error happened'\n)\n;\nbreak\n;\n}\n}\nelse\n{\nalert\n(\n'Unknown error happened'\n)\n;\n}\n}\n判断当前是否连接\n#\n获取当前是否有连接钱包\n示例\nvar\nconnect\n:\nboolean\n=\nokxTonConnect\n.\nconnected\n(\n)\n发送交易\n#\n向钱包发送消息的方法：\nsendTransaction(transaction, options): Promise<SendTransactionResponse>\n请求参数\ntransaction - object\nvalidUntil - number :unix 时间戳。该时刻之后交易将无效\nfrom - string (可选): DApp发送交易的发送者地址，默认为当前连接的钱包地址；\nmessages - object[] : （信息数组）： 1-4 条从钱包合约到其他账户的输出消息。所有消息按顺序发送出去，但\n钱包无法保证消息会按相同顺序被传递和执行\naddress - string : 消息目的地\namount - string : 要发送的数量\nstateInit - string (可选) : 以 Base64 编码的原始cell BoC\npayload - string (可选): 以 Base64 编码的原始cell BoC\noptions - object\nonRequestSent - () => void : 当签名请求发送后，该方法会被调用\n返回值\nPromise -\n{boc: string}\n: 签名结果\n示例\nimport\n{\nOKXConnectError\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nlet\ntransactionRequest\n=\n{\n\"validUntil\"\n:\nDate\n.\nnow\n(\n)\n/\n1000\n+\n360\n,\n\"from\"\n:\n\"0:348bcf827469c5fc38541c77fdd91d4e347eac200f6f2d9fd62dc08885f0415f\"\n,\n\"messages\"\n:\n[\n{\n\"address\"\n:\n\"0:412410771DA82CBA306A55FA9E0D43C9D245E38133CB58F1457DFB8D5CD8892F\"\n,\n\"amount\"\n:\n\"20000000\"\n,\n\"stateInit\"\n:\n\"base64bocblahblahblah==\"\n//deploy contract\n}\n,\n{\n\"address\"\n:\n\"0:E69F10CC84877ABF539F83F879291E5CA169451BA7BCE91A37A5CED3AB8080D3\"\n,\n\"amount\"\n:\n\"60000000\"\n,\n\"payload\"\n:\n\"base64bocblahblahblah==\"\n//transfer nft to new deployed account 0:412410771DA82CBA306A55FA9E0D43C9D245E38133CB58F1457DFB8D5CD8892F\n}\n]\n}\nlet\nrequestOptions\n=\n{\nonRequestSent\n:\n(\n)\n=>\n{\n//requestMsgSend\n}\n}\ntry\n{\nconst\nresult\n=\nawait\nokxTonConnect\n.\nsendTransaction\n(\ntransactionRequest\n,\nrequestOptions\n)\n;\n}\ncatch\n(\nerror\n)\n{\nif\n(\nerror\ninstanceof\nOKXConnectError\n)\n{\nswitch\n(\nerror\n.\ncode\n)\n{\ncase\nOKX_CONNECT_ERROR_CODES\n.\nUSER_REJECTS_ERROR\n:\nalert\n(\n'You rejected the transaction.'\n)\n;\nbreak\n;\ncase\nOKX_CONNECT_ERROR_CODES\n.\nNOT_CONNECTED_ERROR\n:\nalert\n(\n'Not connected'\n)\n;\nbreak\n;\ndefault\n:\nalert\n(\n'Unknown error happened'\n)\n;\nbreak\n;\n}\n}\nelse\n{\nalert\n(\n'Unknown error happened'\n)\n;\n}\n}\n监听钱包状态变化\n#\n钱包状态有：连接成功、恢复连接成功、断开连接等，都可以用此方法获取状态\nonStatusChange( callback: (walletInfo) => void, errorsHandler?: (err) => void ): () => void;\n请求参数\ncallback - (walletInfo) => void : 钱包状态发生变化时候，该callback 会被调用\nwalletinfo - object\ndevice - object\nappName - string : 钱包名称\nplatform - string : 钱包的平台，（android,ios）\nappVersion - string : 钱包版本号\nmaxProtocolVersion - number :\nfeatures - string[] : 支持的方法，当前版本是 sendTransaction\naccount - Account\naddress - string : TON address raw (\n0:<hex>\n)\nchain - \"-239\"\nwalletStateInit - string : Base64 (not url safe) encoded stateinit cell for the wallet contract\npublicKey - string : HEX string without 0x\nconnectItems - object\nname - string : \"ton_proof\"\nproof - object\ntimestamp - number : 时间戳\ndomain - object\nlengthBytes - number : AppDomain Length\nvalue - string : app domain name (as url part, without encoding)\npayload - string: Base64-encoded signature\nsignature - string: payload from the request\nerrorsHandler - (err: OKXConnectError) => void : 钱包状态发生变化出现异常的时候，该errorsHandler 会被调用\nerr - TonConnectError\ncode - number\nmessage - string\n返回值\n() => void : 当不再需要监听更新时，执行该方法以节省资源\n示例\nimport\n{\nWallet\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nconst\nunsubscribe\n=\nokxTonConnect\n.\nonStatusChange\n(\n(\nwalletInfo\n:\nWallet\n|\nnull\n)\n=>\n{\nconsole\n.\nlog\n(\n'Connection status:'\n,\nwalletInfo\n)\n;\n}\n,\n(\nerr\n:\nOKXConnectError\n)\n=>\n{\nconsole\n.\nlog\n(\n'Connection status:'\n,\nerr\n)\n;\n}\n)\n当不再需要监听更新时，调用unsubscribe节省资源\nunsubscribe\n(\n)\n监听事件\n#\n在以下事件发生时，会发送对应事件通知，Dapp可以根据需要添加监听，来处理对应的逻辑\nevent事件\n事件名称\n触发时机\nOKX_TON_CONNECTION_STARTED\n当用户开始连接钱包时\nOKX_TON_CONNECTION_COMPLETED\n当用户成功连接钱包时\nOKX_TON_CONNECTION_ERROR\n当用户取消连接或连接过程中出现错误时\nOKX_TON_CONNECTION_RESTORING_STARTED\n当 dApp 开始恢复连接时\nOKX_TON_CONNECTION_RESTORING_COMPLETED\n当 dApp 成功恢复连接时\nOKX_TON_CONNECTION_RESTORING_ERROR\n当 dApp 无法恢复连接时\nOKX_TON_DISCONNECTION\n当用户开始断开钱包连接时\nOKX_TON_TRANSACTION_SENT_FOR_SIGNATURE\n当用户发送交易以供签名时\nOKX_TON_TRANSACTION_SIGNED\n当用户成功签署交易时\nOKX_TON_TRANSACTION_SIGNING_FAILED\n当用户取消交易签名或签名过程中出现错误时\n示例\nimport\n{\nOKX_TON_CONNECTION_AND_TRANSACTION_EVENT\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nwindow\n.\naddEventListener\n(\nOKX_TON_CONNECTION_AND_TRANSACTION_EVENT\n.\nOKX_TON_CONNECTION_STARTED\n,\n(\nevent\n)\n=>\n{\nif\n(\nevent\ninstanceof\nCustomEvent\n)\n{\nconsole\n.\nlog\n(\n'Transaction init'\n,\nevent\n.\ndetail\n)\n;\n}\n}\n)\n;\n获取账户信息\n#\n获取当前连接的 account\n示例\nimport\n{\nAccount\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nvar\nconnect\n:\nAccount\n=\nokxTonConnect\n.\naccount\n(\n)\n获取钱包信息\n#\n获取当前连接的 wallet\n示例\nimport\n{\nWallet\n}\nfrom\n\"@okxconnect/tonsdk\"\n;\nvar\nconnect\n:\nWallet\n=\nokxTonConnect\n.\nwallet\n(\n)\nEvent事件\n#\n// 生成 universalLink\nuniversalUi\n.\non\n(\n\"display_uri\"\n,\n(\nuri\n)\n=>\n{\nconsole\n.\nlog\n(\nuri\n)\n;\n}\n)\n;\n// session 信息变更会触发该事件；\nuniversalUi\n.\non\n(\n\"session_update\"\n,\n(\nsession\n)\n=>\n{\nconsole\n.\nlog\n(\nJSON\n.\nstringify\n(\nsession\n)\n)\n;\n}\n)\n;\n// 断开连接会触发该事件；\nuniversalUi\n.\non\n(\n\"session_delete\"\n,\n(\n{\ntopic\n}\n)\n=>\n{\nconsole\n.\nlog\n(\ntopic\n)\n;\n}\n)\n;\n// 连接并签名时,签名结果会触发该事件;\nuniversalUi\n.\non\n(\n\"connect_signResponse\"\n,\n(\nsignResponse\n)\n=>\n{\nconsole\n.\nlog\n(\nsignResponse\n)\n;\n}\n)\n;\n错误码\n#\n在连接，交易，断开连接的过程中可能抛出的异常;\n异常\n错误码\n描述\nOKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR\n未知异常\nOKX_CONNECT_ERROR_CODES.ALREADY_CONNECTED_ERROR\n钱包已连接\nOKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR\n钱包未连接\nOKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR\n用户拒绝\nOKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED\n方法不支持\nOKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED\n链不支持\nOKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED\n钱包不支持\nOKX_CONNECT_ERROR_CODES.CONNECTION_ERROR\n连接异常\nexport\nenum\nOKX_CONNECT_ERROR_CODES\n{\nUNKNOWN_ERROR\n=\n0\n,\nALREADY_CONNECTED_ERROR\n=\n11\n,\nNOT_CONNECTED_ERROR\n=\n12\n,\nUSER_REJECTS_ERROR\n=\n300\n,\nMETHOD_NOT_SUPPORTED\n=\n400\n,\nCHAIN_NOT_SUPPORTED\n=\n500\n,\nWALLET_NOT_SUPPORTED\n=\n600\n,\nCONNECTION_ERROR\n=\n700\n}",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"sdk\">SDK<a class=\"index_header-anchor__Xqb+L\" href=\"#sdk\" style=\"opacity:0\">#</a></h1>\n<p>如果您之前使用过Ton Connect，可以继续使用此文档连接，可以减少开发成本。</p>\n<p>如果您之前使用过OKX Connect，可以跳转去使用ProviderSDK进行连接，可以减少开发成本，并且可以支持多个网络同时请求。</p>\n<a class=\"flex justify-start items-center index_card__Pvw5e\" href=\"/zh-hans/build/dev-docs/sdks/app-connect-ton-provider-sdk\"><i aria-hidden=\"true\" class=\"icon iconfont okx-defi-okc-tf-contract index_icon__jz5er\" role=\"img\"></i><div class=\"index_head__iMYf1\"><div class=\"truncate index_title__Tcv0Y\">ProviderSDK</div></div></a>\n<h2 data-content=\"安装SDK\" id=\"安装sdk\">安装SDK<a class=\"index_header-anchor__Xqb+L\" href=\"#安装sdk\" style=\"opacity:0\">#</a></h2>\n<p>可以通过cdn或者npm安装SDK</p>\n<p><strong>通过cdn安装</strong>\n将如下代码添加到HTML文件中，也可以将latest替换为特定的版本号例如1.6.1。</p>\n<p><code>&lt;script src=\"https://unpkg.com/@okxconnect/tonsdk@latest/dist/okxconnect_tonsdk.min.js\"&gt;&lt;/script&gt;</code></p>\n<p>引入后，OKXTonConnectSDK会作为全局对象可以直接引用</p>\n<p><code>&lt;script&gt; const connector = new OKXTonConnectSDK.OKXTonConnect(); &lt;/script&gt;</code></p>\n<p><strong>通过npm安装</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">npm install @okxconnect/tonsdk</code></pre></div>\n<h2 data-content=\"初始化\" id=\"初始化\">初始化<a class=\"index_header-anchor__Xqb+L\" href=\"#初始化\" style=\"opacity:0\">#</a></h2>\n<p>连接钱包之前，需要先创建一个对象，用于后续连接钱包、发送交易等操作</p>\n<p><code>new OKXTonConnect({metaData: {name, icon}})</code></p>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>metaData - object<!-- -->\n<ul>\n<li>name - string: 应用名称，不会作为唯一表示</li>\n<li>icon - string: 应用图标的 URL。必须是 PNG、ICO 等格式，不支持 SVG 图标。最好传递指向 180x180px PNG 图标的 url。</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>okxTonConnect - OKXTonConnect</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> OKXTonConnect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> okxTonConnect <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OKXTonConnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    metaData<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">\"application name\"</span><span class=\"token punctuation\">,</span>\n        icon<span class=\"token operator\">:</span> <span class=\"token string\">\"application icon url\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"连接钱包\" id=\"连接钱包\">连接钱包<a class=\"index_header-anchor__Xqb+L\" href=\"#连接钱包\" style=\"opacity:0\">#</a></h2>\n<p>连接钱包去获取钱包地址，作为标识符和用于签名交易的必要参数</p>\n<p><code>connect(request): Promise&lt;string&gt;;</code></p>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>request - object (可选)<!-- -->\n<ul>\n<li>tonProof - string (可选) : 签名信息</li>\n<li>redirect - string (可选) : 处理完钱包事件，返回的app 所需要的deeplink，例如：在 Telegram 环境下，此字段需要传递 Telegram\n的deeplink，当在钱包签名完成后，OKX App 会通过此deeplink 打开 Telegram 程序，非Telegram环境建议不设置</li>\n<li>openUniversalLink - boolean (可选) : 连接钱包时,是否通过 Universal link 唤起 OKX App 客户端；设置为 true\n的情况下，用户发起连接钱包时，会拉起 OKX App 客户端，并弹出确认页面，如果手机未安装 OKX App 客户端，跳转到下载页</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>Promise - string: PC 网页端可以根据该字段生成二维码，OKX App 客户端在 web3 中扫描生成的二维码，连接 DApp</li>\n</ul>\n<p><strong>建议</strong></p>\n<ul>\n<li>在手机浏览器或者手机 Telegram 环境下设置 openUniversalLink 为 true</li>\n<li>在 PC 浏览器环境下设置 openUniversalLink 为 false，并根据返回的 universalLink 生成二维码，可以用 OKX App 客户端扫码连接，在连接成功后，取消二维码弹窗</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> OKXConnectError <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        tonProof<span class=\"token operator\">:</span> <span class=\"token string\">\"signmessage\"</span><span class=\"token punctuation\">,</span>\n        redirect<span class=\"token operator\">:</span> <span class=\"token string\">\"tg://resolve\"</span><span class=\"token punctuation\">,</span>\n        openUniversalLink<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">OKXConnectError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>code <span class=\"token operator\">===</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">USER_REJECTS_ERROR</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'User reject'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>code <span class=\"token operator\">===</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ALREADY_CONNECTED_ERROR</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Already connected'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"恢复连接\" id=\"恢复连接\">恢复连接<a class=\"index_header-anchor__Xqb+L\" href=\"#恢复连接\" style=\"opacity:0\">#</a></h2>\n<p>如果用户之前连接过钱包，在再次进入或页面刷新时可调用此方法，用来恢复之前的连接状态</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">restoreConnection(): Promise&lt;void&gt;</code></pre></div>\n<p><strong>请求参数</strong></p>\n<p>无</p>\n<p><strong>返回值</strong></p>\n<p>无</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">restoreConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"断开连接\" id=\"断开连接\">断开连接<a class=\"index_header-anchor__Xqb+L\" href=\"#断开连接\" style=\"opacity:0\">#</a></h2>\n<p>断开已连接钱包，并删除当前会话，如果要切换连接钱包，请先断开当前钱包</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">OKXConnectError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">NOT_CONNECTED_ERROR</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Not connected'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"判断当前是否连接\" id=\"判断当前是否连接\">判断当前是否连接<a class=\"index_header-anchor__Xqb+L\" href=\"#判断当前是否连接\" style=\"opacity:0\">#</a></h2>\n<p>获取当前是否有连接钱包</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">var</span> connect<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span> <span class=\"token operator\">=</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"发送交易\" id=\"发送交易\">发送交易<a class=\"index_header-anchor__Xqb+L\" href=\"#发送交易\" style=\"opacity:0\">#</a></h2>\n<p>向钱包发送消息的方法：</p>\n<p><code>sendTransaction(transaction, options): Promise&lt;SendTransactionResponse&gt;</code></p>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>transaction - object<!-- -->\n<ul>\n<li>validUntil - number :unix 时间戳。该时刻之后交易将无效</li>\n<li>from - string (可选): DApp发送交易的发送者地址，默认为当前连接的钱包地址；</li>\n<li>messages - object[] : （信息数组）： 1-4 条从钱包合约到其他账户的输出消息。所有消息按顺序发送出去，但\n钱包无法保证消息会按相同顺序被传递和执行<!-- -->\n<ul>\n<li>address - string : 消息目的地</li>\n<li>amount - string : 要发送的数量</li>\n<li>stateInit - string (可选) : 以 Base64 编码的原始cell BoC</li>\n<li>payload - string (可选): 以 Base64 编码的原始cell BoC</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>options - object<!-- -->\n<ul>\n<li>onRequestSent - () =&gt; void : 当签名请求发送后，该方法会被调用</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>Promise - <code>{boc: string}</code>: 签名结果</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> OKXConnectError <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> transactionRequest <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"validUntil\"</span><span class=\"token operator\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000</span> <span class=\"token operator\">+</span> <span class=\"token number\">360</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"from\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0:348bcf827469c5fc38541c77fdd91d4e347eac200f6f2d9fd62dc08885f0415f\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"messages\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string-property property\">\"address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0:412410771DA82CBA306A55FA9E0D43C9D245E38133CB58F1457DFB8D5CD8892F\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"amount\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"20000000\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"stateInit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"base64bocblahblahblah==\"</span> <span class=\"token comment\">//deploy contract</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string-property property\">\"address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0:E69F10CC84877ABF539F83F879291E5CA169451BA7BCE91A37A5CED3AB8080D3\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"amount\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"60000000\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string-property property\">\"payload\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"base64bocblahblahblah==\"</span> <span class=\"token comment\">//transfer nft to new deployed account 0:412410771DA82CBA306A55FA9E0D43C9D245E38133CB58F1457DFB8D5CD8892F</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> requestOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">onRequestSent</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//requestMsgSend</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">sendTransaction</span><span class=\"token punctuation\">(</span>transactionRequest<span class=\"token punctuation\">,</span> requestOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">OKXConnectError</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">case</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">USER_REJECTS_ERROR</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'You rejected the transaction.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">case</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span><span class=\"token punctuation\">.</span><span class=\"token constant\">NOT_CONNECTED_ERROR</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Not connected'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n                <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Unknown error happened'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"监听钱包状态变化\" id=\"监听钱包状态变化\">监听钱包状态变化<a class=\"index_header-anchor__Xqb+L\" href=\"#监听钱包状态变化\" style=\"opacity:0\">#</a></h2>\n<p>钱包状态有：连接成功、恢复连接成功、断开连接等，都可以用此方法获取状态</p>\n<p><code>onStatusChange( callback: (walletInfo) =&gt; void, errorsHandler?: (err) =&gt; void ): () =&gt; void;</code></p>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>\n<p>callback - (walletInfo) =&gt; void : 钱包状态发生变化时候，该callback 会被调用</p>\n<ul>\n<li>walletinfo - object<!-- -->\n<ul>\n<li>device - object<!-- -->\n<ul>\n<li>appName - string : 钱包名称</li>\n<li>platform - string : 钱包的平台，（android,ios）</li>\n<li>appVersion - string : 钱包版本号</li>\n<li>maxProtocolVersion - number :</li>\n<li>features - string[] : 支持的方法，当前版本是 sendTransaction</li>\n</ul>\n</li>\n<li>account - Account<!-- -->\n<ul>\n<li>address - string : TON address raw (<code>0:&lt;hex&gt;</code>)</li>\n<li>chain - \"-239\"</li>\n<li>walletStateInit - string : Base64 (not url safe) encoded stateinit cell for the wallet contract</li>\n<li>publicKey - string : HEX string without 0x</li>\n</ul>\n</li>\n<li>connectItems - object<!-- -->\n<ul>\n<li>name - string : \"ton_proof\"</li>\n<li>proof - object<!-- -->\n<ul>\n<li>timestamp - number : 时间戳</li>\n<li>domain - object<!-- -->\n<ul>\n<li>lengthBytes - number : AppDomain Length</li>\n<li>value - string : app domain name (as url part, without encoding)</li>\n</ul>\n</li>\n<li>payload - string: Base64-encoded signature</li>\n<li>signature - string: payload from the request</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>errorsHandler - (err: OKXConnectError) =&gt; void : 钱包状态发生变化出现异常的时候，该errorsHandler 会被调用</p>\n<ul>\n<li>err - TonConnectError<!-- -->\n<ul>\n<li>code - number</li>\n<li>message - string</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>() =&gt; void : 当不再需要监听更新时，执行该方法以节省资源</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Wallet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> unsubscribe <span class=\"token operator\">=</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">onStatusChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>walletInfo<span class=\"token operator\">:</span> Wallet <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Connection status:'</span><span class=\"token punctuation\">,</span> walletInfo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>err<span class=\"token operator\">:</span> OKXConnectError<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Connection status:'</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>当不再需要监听更新时，调用unsubscribe节省资源</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"监听事件\" id=\"监听事件\">监听事件<a class=\"index_header-anchor__Xqb+L\" href=\"#监听事件\" style=\"opacity:0\">#</a></h2>\n<p>在以下事件发生时，会发送对应事件通知，Dapp可以根据需要添加监听，来处理对应的逻辑</p>\n<p><strong>event事件</strong></p>\n<div class=\"index_table__kvZz5\"><table><thead><tr><th>事件名称</th><th>触发时机</th></tr></thead><tbody><tr><td>OKX_TON_CONNECTION_STARTED</td><td>当用户开始连接钱包时</td></tr><tr><td>OKX_TON_CONNECTION_COMPLETED</td><td>当用户成功连接钱包时</td></tr><tr><td>OKX_TON_CONNECTION_ERROR</td><td>当用户取消连接或连接过程中出现错误时</td></tr><tr><td>OKX_TON_CONNECTION_RESTORING_STARTED</td><td>当 dApp 开始恢复连接时</td></tr><tr><td>OKX_TON_CONNECTION_RESTORING_COMPLETED</td><td>当 dApp 成功恢复连接时</td></tr><tr><td>OKX_TON_CONNECTION_RESTORING_ERROR</td><td>当 dApp 无法恢复连接时</td></tr><tr><td>OKX_TON_DISCONNECTION</td><td>当用户开始断开钱包连接时</td></tr><tr><td>OKX_TON_TRANSACTION_SENT_FOR_SIGNATURE</td><td>当用户发送交易以供签名时</td></tr><tr><td>OKX_TON_TRANSACTION_SIGNED</td><td>当用户成功签署交易时</td></tr><tr><td>OKX_TON_TRANSACTION_SIGNING_FAILED</td><td>当用户取消交易签名或签名过程中出现错误时</td></tr></tbody></table></div>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">OKX_TON_CONNECTION_AND_TRANSACTION_EVENT</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token constant\">OKX_TON_CONNECTION_AND_TRANSACTION_EVENT</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OKX_TON_CONNECTION_STARTED</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">CustomEvent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Transaction init'</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">.</span>detail<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"获取账户信息\" id=\"获取账户信息\">获取账户信息<a class=\"index_header-anchor__Xqb+L\" href=\"#获取账户信息\" style=\"opacity:0\">#</a></h2>\n<p>获取当前连接的 account</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Account <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> connect<span class=\"token operator\">:</span> Account <span class=\"token operator\">=</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">account</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"获取钱包信息\" id=\"获取钱包信息\">获取钱包信息<a class=\"index_header-anchor__Xqb+L\" href=\"#获取钱包信息\" style=\"opacity:0\">#</a></h2>\n<p>获取当前连接的 wallet</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Wallet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/tonsdk\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> connect<span class=\"token operator\">:</span> Wallet <span class=\"token operator\">=</span> okxTonConnect<span class=\"token punctuation\">.</span><span class=\"token function\">wallet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"Event事件\" id=\"event事件\">Event事件<a class=\"index_header-anchor__Xqb+L\" href=\"#event事件\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 生成 universalLink</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"display_uri\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>uri<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>uri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// session 信息变更会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"session_update\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 断开连接会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"session_delete\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>topic<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 连接并签名时,签名结果会触发该事件;</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connect_signResponse\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"错误码\" id=\"错误码\">错误码<a class=\"index_header-anchor__Xqb+L\" href=\"#错误码\" style=\"opacity:0\">#</a></h2>\n<p>在连接，交易，断开连接的过程中可能抛出的异常;</p>\n<p><strong>异常</strong></p>\n<div class=\"index_table__kvZz5\"><table><thead><tr><th>错误码</th><th>描述</th></tr></thead><tbody><tr><td>OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR</td><td>未知异常</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.ALREADY_CONNECTED_ERROR</td><td>钱包已连接</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR</td><td>钱包未连接</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR</td><td>用户拒绝</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED</td><td>方法不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED</td><td>链不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED</td><td>钱包不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.CONNECTION_ERROR</td><td>连接异常</td></tr></tbody></table></div>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">UNKNOWN_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">ALREADY_CONNECTED_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">NOT_CONNECTED_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">USER_REJECTS_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">METHOD_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">CHAIN_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">WALLET_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">CONNECTION_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">700</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/app-connect-ton-sdk#断开连接",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "Ton",
      "SDK"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SDK",
      "UI",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链"
    ],
    "toc": [
      "安装SDK",
      "初始化",
      "连接钱包",
      "恢复连接",
      "断开连接",
      "判断当前是否连接",
      "发送交易",
      "监听钱包状态变化",
      "监听事件",
      "获取账户信息",
      "获取钱包信息",
      "Event事件",
      "错误码"
    ]
  },
  "word_count": 1125,
  "extract_time": "2025-05-27 07:33:46"
}