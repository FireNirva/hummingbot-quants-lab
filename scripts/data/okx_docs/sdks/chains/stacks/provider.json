{
  "title": "Provider API | stacks | 连接浏览器插件钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "Provider API\n#\n什么是 Injected provider API？\n#\n欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。\n连接账户\n#\nwindow.okxwallet.stacks.connect()\n描述\n通过调用\nwindow.okxwallet.stacks.connect()\n连接欧易 Web3 钱包。\n当成功调用\nwindow.okxwallet.stacks.connect()\n，将会唤起欧易 Web3 钱包连接钱包页面，用户可以决定是否连接当前 DApp，如果用户同意将会返回地址 (\naddress\n) 和公钥 (\npublic key\n)。\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\nstacks\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nresponse\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n合约调用\n#\nwindow.okxwallet.stacks.signTransaction(transaction)\n参数\ntransaction - object\nstxAddress - string: 当前连接的钱包的 stx 地址\ntxType - string: 交易类型，必须传入\ncontract_call\ncontractName - string: 合约名称\ncontractAddress - string: 合约地址\nfunctionName - string: 函数名称\nfunctionArgs - array<string>: 16进制序列化的合约调用数据\npostConditionMode - number: (非必需)是否允许后置条件\n1: 允许\n2: 拒绝\npostConditions - array<string>: (非必需)后置条件的参数\nanchorMode - number: (非必需)交易上链的方式\n1: 交易必须被 anchored block 接收\n2: 交易必须被 microblock 接收\n3: 可以任意选择一种接收方式\n返回值\nresult - object\ntxHash - string: 交易哈希\nsignature - string: 签名字符串\ntry\n{\nconst\ntransaction\n=\n{\n\"stxAddress\"\n:\n\"\"\n,\n\"txType\"\n:\n\"contract_call\"\n,\n\"contractName\"\n:\n\"amm-swap-pool-v1-1\"\n,\n\"contractAddress\"\n:\n\"SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9\"\n,\n\"functionName\"\n:\n\"swap-helper\"\n,\n\"functionArgs\"\n:\n[\n\"0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a746f6b656e2d77737478\"\n,\n\"0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e\"\n,\n\"0100000000000000000000000005f5e100\"\n,\n\"01000000000000000000000000000f4240\"\n,\n\"0a010000000000000000000000000078b854\"\n]\n,\n\"postConditionMode\"\n:\n2\n,\n\"postConditions\"\n:\n[\n\"000216c03b5520cf3a0bd270d8e41e5e19a464aef6294c010000000000002710\"\n,\n\"010316e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0f616c65782d7661756c742d76312d3116e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e04616c657803000000000078b854\"\n]\n,\n\"anchorMode\"\n:\n3\n,\n}\n;\nconst\n{\ntxHash\n,\nsignature\n}\n=\nawait\nwindow\n.\nokxwallet\n.\nstacks\n.\nsignTransaction\n(\ntransaction\n)\n;\nconsole\n.\nlocation\n(\n{\ntxHash\n,\nsignature\n}\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n}\n转账交易\n#\nwindow.okxwallet.stacks.signTransaction(transaction)\n参数\ntransaction - object\nstxAddress - string: 当前连接的钱包的 stx 地址\ntxType - string: 交易类型，必须传入\ntoken_transfer\nrecipient - string: 接收地址\namount - stirng: 发送的数量\nmemo - stirng: (非必需)备注信息\nanchorMode - number: (非必需)交易上链的方式\n1: 交易必须被 anchored block 接收\n2: 交易必须被 microblock 接收\n3: 可以任意选择一种接收方式\n返回值\nresult - object\ntxHash - string: 交易哈希\nsignature - string: 签名字符串\ntry\n{\nconst\ntransaction\n=\n{\nstxAddress\n:\n''\n,\ntxType\n:\n'token_transfer'\n,\nrecipient\n:\n''\n,\namount\n:\n'10000'\n,\nmemo\n:\n'test'\n}\n;\nconst\n{\ntxHash\n,\nsignature\n}\n=\nawait\nwindow\n.\nokxwallet\n.\nstacks\n.\nsignTransaction\n(\ntransaction\n)\n;\nconsole\n.\nlocation\n(\n{\ntxHash\n,\nsignature\n}\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n}\n签名消息\n#\nwindow.okxwallet.stacks.signMessage(data)\n参数\ndata - object\nmessage - string: 需要签名的数据\n返回值\nresult - object\npublicKey - string: 验签的公钥\nsignature - string: 签名字符串\ntry\n{\nconst\ndata\n=\n{\nmessage\n:\n'1234'\n}\n;\nconst\n{\npublicKey\n,\nsignature\n}\n=\nawait\nwindow\n.\nokxwallet\n.\nstacks\n.\nsignMessage\n(\ndata\n)\n;\nconsole\n.\nlocation\n(\n{\npublicKey\n,\nsignature\n}\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n}",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"provider-api\">Provider API<a class=\"index_header-anchor__Xqb+L\" href=\"#provider-api\" style=\"opacity:0\">#</a></h1>\n<h2 data-content=\"什么是 Injected provider API？\" id=\"什么是-injected-provider-api？\">什么是 Injected provider API？<a class=\"index_header-anchor__Xqb+L\" href=\"#什么是-injected-provider-api？\" style=\"opacity:0\">#</a></h2>\n<p>欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。</p>\n<h2 data-content=\"连接账户\" id=\"连接账户\">连接账户<a class=\"index_header-anchor__Xqb+L\" href=\"#连接账户\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.stacks.connect()</code></p>\n<p><strong>描述</strong></p>\n<p>通过调用 <code>window.okxwallet.stacks.connect()</code> 连接欧易 Web3 钱包。</p>\n<p>当成功调用 <code>window.okxwallet.stacks.connect()</code>，将会唤起欧易 Web3 钱包连接钱包页面，用户可以决定是否连接当前 DApp，如果用户同意将会返回地址 (<code>address</code>) 和公钥 (<code>public key</code>)。</p>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">stacks</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"合约调用\" id=\"合约调用\">合约调用<a class=\"index_header-anchor__Xqb+L\" href=\"#合约调用\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.stacks.signTransaction(transaction)</code></p>\n<p><strong>参数</strong></p>\n<ul>\n<li>transaction - object<!-- -->\n<ul>\n<li>stxAddress - string: 当前连接的钱包的 stx 地址</li>\n<li>txType - string: 交易类型，必须传入 <code>contract_call</code></li>\n<li>contractName - string: 合约名称</li>\n<li>contractAddress - string: 合约地址</li>\n<li>functionName - string: 函数名称</li>\n<li>functionArgs - array&lt;string&gt;: 16进制序列化的合约调用数据</li>\n<li>postConditionMode - number: (非必需)是否允许后置条件<!-- -->\n<ul>\n<li>1: 允许</li>\n<li>2: 拒绝</li>\n</ul>\n</li>\n<li>postConditions - array&lt;string&gt;: (非必需)后置条件的参数</li>\n<li>anchorMode - number: (非必需)交易上链的方式<!-- -->\n<ul>\n<li>1: 交易必须被 anchored block 接收</li>\n<li>2: 交易必须被 microblock 接收</li>\n<li>3: 可以任意选择一种接收方式</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>result - object<!-- -->\n<ul>\n<li>txHash - string: 交易哈希</li>\n<li>signature - string: 签名字符串</li>\n</ul>\n</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> transaction <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string-property property\">\"stxAddress\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"txType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"contract_call\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"contractName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"amm-swap-pool-v1-1\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"contractAddress\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"functionName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"swap-helper\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"functionArgs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a746f6b656e2d77737478\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"0100000000000000000000000005f5e100\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"01000000000000000000000000000f4240\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"0a010000000000000000000000000078b854\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"postConditionMode\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"postConditions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"000216c03b5520cf3a0bd270d8e41e5e19a464aef6294c010000000000002710\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token string\">\"010316e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0f616c65782d7661756c742d76312d3116e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e04616c657803000000000078b854\"</span>\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string-property property\">\"anchorMode\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>txHash<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">stacks</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signTransaction</span><span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">location</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>txHash<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"转账交易\" id=\"转账交易\">转账交易<a class=\"index_header-anchor__Xqb+L\" href=\"#转账交易\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.stacks.signTransaction(transaction)</code></p>\n<p><strong>参数</strong></p>\n<ul>\n<li>transaction - object<!-- -->\n<ul>\n<li>stxAddress - string: 当前连接的钱包的 stx 地址</li>\n<li>txType - string: 交易类型，必须传入 <code>token_transfer</code></li>\n<li>recipient - string: 接收地址</li>\n<li>amount - stirng: 发送的数量</li>\n<li>memo - stirng: (非必需)备注信息</li>\n<li>anchorMode - number: (非必需)交易上链的方式<!-- -->\n<ul>\n<li>1: 交易必须被 anchored block 接收</li>\n<li>2: 交易必须被 microblock 接收</li>\n<li>3: 可以任意选择一种接收方式</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>result - object<!-- -->\n<ul>\n<li>txHash - string: 交易哈希</li>\n<li>signature - string: 签名字符串</li>\n</ul>\n</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> transaction <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">stxAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">txType</span><span class=\"token operator\">:</span> <span class=\"token string\">'token_transfer'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">recipient</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token string\">'10000'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">memo</span><span class=\"token operator\">:</span> <span class=\"token string\">'test'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>txHash<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">stacks</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signTransaction</span><span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">location</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>txHash<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"签名消息\" id=\"签名消息\">签名消息<a class=\"index_header-anchor__Xqb+L\" href=\"#签名消息\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.stacks.signMessage(data)</code></p>\n<p><strong>参数</strong></p>\n<ul>\n<li>data - object<!-- -->\n<ul>\n<li>message - string: 需要签名的数据</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>result - object<!-- -->\n<ul>\n<li>publicKey - string: 验签的公钥</li>\n<li>signature - string: 签名字符串</li>\n</ul>\n</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'1234'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>publicKey<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">stacks</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signMessage</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">location</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>publicKey<span class=\"token punctuation\">,</span> signature<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/chains/stacks/provider#provider-api",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "stacks",
      "Provider API"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链",
      "TON",
      "Aptos/Movement"
    ],
    "toc": [
      "什么是 Injected provider API？",
      "连接账户",
      "合约调用",
      "转账交易",
      "签名消息"
    ]
  },
  "word_count": 476,
  "extract_time": "2025-05-27 07:35:26"
}