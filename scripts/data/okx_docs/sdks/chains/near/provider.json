{
  "title": "Provider API | near | 连接浏览器插件钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "Provider API\n#\n什么是 Injected provider API？\n#\n欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。\n获取注入的对象\n#\nDapp 可以通过如下方式访问注入的对象：\nwindow.okxwallet.near\n- 推荐\nwindow.near\n连接钱包\n#\nrequestSignIn()\n#\n/**\n*\n@param\n{\nString\n}\ncontractId\ncontract account id\n*\n@param\n{\nArray\n}\nmethodNames\nmethods on the contract should be allowed to be called.\n*\n@returns\n{\naccountId\n,\naccessKey\n}\naccountId and signed in access key\n*/\nwindow\n.\nokxwallet\n.\nnear\n.\nrequestSignIn\n(\n{\ncontractId\n=\n''\n,\nmethodNames\n=\n[\n]\n}\n)\n:\nPromise\n<\nResult\n>\n仅获取 accountId\n#\n不传 contractId 和 methodNames 只会获取到用户的 NEAR 地址.\ntry\n{\nconst\n{\naccountId\n}\n=\nwindow\n.\nokxwallet\n.\nnear\n.\nrequestSignIn\n(\n)\n;\n}\ncatch\n(\n_\n)\n{\n// something error\n}\n返回值示例:\n{\n\"accountId\"\n:\n\"efad2c...9dae\"\n,\n}\n获取 accessKey\n#\n传入 contractId 和 methodNames, 钱包会返回 accessKey\nconst\ncontractId\n=\n'wrap.near'\n;\nconst\nmethodNames\n=\n[\n'ft_metadata'\n]\n;\ntry\n{\nconst\n{\naccountId\n,\naccessKey\n}\n=\nwindow\n.\nokxwallet\n.\nnear\n.\nrequestSignIn\n(\n{\ncontractId\n,\nmethodNames\n}\n)\n;\n}\ncatch\n(\n_\n)\n{\n// something error\n}\n返回值示例:\n{\n\"accountId\"\n:\n\"efad2c...9dae\"\n,\n\"accessKey\"\n:\n{\n\"secretKey\"\n:\n\"5S9Ngi...Uku6\"\n,\n\"publicKey\"\n:\n\"ed25519:9RivAy...Hxc8\"\n}\n}\nsignOut()\n#\n断开钱包连接\nwindow\n.\nokxwallet\n.\nnear\n.\nsignOut\n(\n)\n:\nvoid\n;\nisSignedIn()\n#\n判断当前账户是否处于连接中状态\nwindow\n.\nokxwallet\n.\nnear\n.\nisSignedIn\n(\n)\n:\nboolean\n;\ngetAccountId()\n#\n获取当前连接的 accountId\nwindow\n.\nokxwallet\n.\nnear\n.\ngetAccountId\n(\n)\n:\nstring\n;\nsignMessage\n#\nnear\n.\nsignMessage\n(\n{\nmessage\n:\nstring\n,\nrecipient\n:\nstring\n,\nnonce\n:\nBuffer\n}\n)\n:\nResponse\n;\n签名, 示例:\nconst\nmessage\n=\n{\nmessage\n:\n'hello world'\n,\nrecipient\n:\n'test.testnet'\n,\nnonce\n:\nBuffer\n.\nfrom\n(\n\"4268ebc14ff247f5450d4a8682bec3729a06d268f83b0cb363083ab05b65486b\"\n,\n\"hex\"\n)\n}\nconst\nresult\n=\nawait\nwindow\n.\nokxwallet\n.\nnear\n.\nsignMessage\n(\nmessage\n)\n;\n返回值示例:\n{\n\"accountId\"\n:\n\"efad2c...9dae\"\n,\n\"publicKey\"\n:\n\"ed25519:H8bbdL...ucKF\"\n,\n\"signature\"\n:\n\"zYbw0Z+YabpZTnYA1REkvAX5KeXt/qRgHkorYfjRR5dD5keySfFuWGMafkfi/RPUpG1EAqbUf9VFt4tTBebcDQ==\"\n}\n合约交互\n#\nsignAndSendTransaction()\n#\nnear\n.\nsignAndSendTransaction\n(\n{\nreceiverId\n:\nstring\n,\nactions\n:\nAction\n[\n]\n}\n)\n:\nResponse\n;\n签名并广播交易, 示例:\nconst\ntx\n=\n{\nreceiverId\n:\n'wrap.near'\n,\nactions\n:\n[\n{\nmethodName\n:\n'near_deposit'\n,\nargs\n:\n{\n}\n,\ndeposit\n:\n'1250000000000000000000'\n,\n}\n,\n]\n,\n}\nconst\nresult\n=\nawait\nwindow\n.\nokxwallet\n.\nnear\n.\nsignAndSendTransaction\n(\ntx\n)\n;\n返回值示例:\n{\n\"method\"\n:\n\"signAndSendTransaction\"\n,\n\"txHash\"\n:\n\"2bNbuT...UdSA\"\n,\n\"code\"\n:\n0\n}\n注意: dapp 需要通过 txHash 获取交易广播的结果\nrequestSignTransactions()\n#\nnear\n.\nrequestSignTransactions\n(\n{\ntransactions\n:\nTransaction\n[\n]\n}\n)\n:\nResponse\n;\n批量签名交易, 示例:\nconst\ntransactions\n=\n[\n{\nreceiverId\n:\n'wrap.near'\n,\nactions\n:\n[\n{\nmethodName\n:\n'near_deposit'\n,\nargs\n:\n{\n}\n,\ndeposit\n:\n'1000000000000000'\n,\n}\n,\n]\n,\n}\n,\n{\nreceiverId\n:\n'wrap.near'\n,\nactions\n:\n[\n{\nmethodName\n:\n'ft_transfer'\n,\nargs\n:\n{\nreceiver_id\n:\n'efad2c...9dae'\n,\namount\n:\n'10000000000'\n,\n}\n,\ndeposit\n:\n'1'\n,\n}\n,\n]\n,\n}\n,\n]\nconst\nresult\n=\nawait\nwindow\n.\nokxwallet\n.\nnear\n.\nsignAndSendTransaction\n(\n{\ntransactions\n}\n)\n;\n返回值示例:\n{\n\"txs\"\n:\n[\n{\n\"signedTx\"\n:\n\"QAAAAG...kAoH\"\n,\n\"txHash\"\n:\n\"71MuUA...KVxt\"\n}\n,\n{\n\"signedTx\"\n:\n\"QAAAAG...gksH\"\n,\n\"txHash\"\n:\n\"8RHzw4...hvLN\"\n}\n]\n,\n\"code\"\n:\n0\n,\n\"method\"\n:\n\"requestSignTransactions\"\n}\n注意: 批量签名交易钱包只会签名, 不会广播. dapp 侧需要承接广播的逻辑.\n事件\n#\nsignIn\n#\n连接钱包成功\nwindow\n.\nokxwallet\n.\nnear\n.\non\n(\n\"signIn\"\n,\n(\n(\naccountId\n)\n=>\n{\n// accountId: 当前连接账户的 accountId\n}\n)\n;\nsignOut\n#\n连接钱包成功\nwindow\n.\nokxwallet\n.\nnear\n.\non\n(\n\"signIn\"\n,\n(\n(\n)\n=>\n{\n// do something\n}\n)\n;\naccountChanged\n#\n钱包侧切换了账户\nwindow\n.\nokxwallet\n.\nnear\n.\non\n(\n\"accountChanged\"\n,\n(\n(\naccountId\n)\n=>\n{\n// accountId: 切换后账户的 accountId\n}\n)\n;",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"provider-api\">Provider API<a class=\"index_header-anchor__Xqb+L\" href=\"#provider-api\" style=\"opacity:0\">#</a></h1>\n<h2 data-content=\"什么是 Injected provider API？\" id=\"什么是-injected-provider-api？\">什么是 Injected provider API？<a class=\"index_header-anchor__Xqb+L\" href=\"#什么是-injected-provider-api？\" style=\"opacity:0\">#</a></h2>\n<p>欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。</p>\n<h2 data-content=\"获取注入的对象\" id=\"获取注入的对象\">获取注入的对象<a class=\"index_header-anchor__Xqb+L\" href=\"#获取注入的对象\" style=\"opacity:0\">#</a></h2>\n<p>Dapp 可以通过如下方式访问注入的对象：</p>\n<ul>\n<li><code>window.okxwallet.near</code> - 推荐</li>\n<li><code>window.near</code></li>\n</ul>\n<h2 data-content=\"连接钱包\" id=\"连接钱包\">连接钱包<a class=\"index_header-anchor__Xqb+L\" href=\"#连接钱包\" style=\"opacity:0\">#</a></h2>\n<h3 id=\"requestsignin()\">requestSignIn()<a class=\"index_header-anchor__Xqb+L\" href=\"#requestsignin()\" style=\"opacity:0\">#</a></h3>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token doc-comment comment\">/**\n* <span class=\"token keyword\">@param</span> <span class=\"token class-name\"><span class=\"token punctuation\">{</span>String<span class=\"token punctuation\">}</span></span> <span class=\"token parameter\">contractId</span> contract account id\n* <span class=\"token keyword\">@param</span> <span class=\"token class-name\"><span class=\"token punctuation\">{</span>Array<span class=\"token punctuation\">}</span></span> <span class=\"token parameter\">methodNames</span> methods on the contract should be allowed to be called.\n* <span class=\"token keyword\">@returns</span> <span class=\"token class-name\"><span class=\"token punctuation\">{</span> accountId<span class=\"token punctuation\">,</span> accessKey <span class=\"token punctuation\">}</span></span> accountId and signed in access key\n*/</span>\n<span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">requestSignIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> contractId <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span> methodNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">Promise</span><span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Result</span><span class=\"token operator\">&gt;</span>\n</code></pre></div>\n<h4 id=\"仅获取-accountid\">仅获取 accountId<a class=\"index_header-anchor__Xqb+L\" href=\"#仅获取-accountid\" style=\"opacity:0\">#</a></h4>\n<p>不传 contractId 和 methodNames 只会获取到用户的 NEAR 地址.</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> accountId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">requestSignIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// something error</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>返回值示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"accountId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"efad2c...9dae\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h4 id=\"获取-accesskey\">获取 accessKey<a class=\"index_header-anchor__Xqb+L\" href=\"#获取-accesskey\" style=\"opacity:0\">#</a></h4>\n<p>传入 contractId 和 methodNames, 钱包会返回 accessKey</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> contractId <span class=\"token operator\">=</span> <span class=\"token string\">'wrap.near'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> methodNames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'ft_metadata'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> accountId<span class=\"token punctuation\">,</span> accessKey <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">requestSignIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> contractId<span class=\"token punctuation\">,</span> methodNames <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// something error</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>返回值示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"accountId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"efad2c...9dae\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"accessKey\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"secretKey\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"5S9Ngi...Uku6\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"publicKey\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ed25519:9RivAy...Hxc8\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h3 id=\"signout()\">signOut()<a class=\"index_header-anchor__Xqb+L\" href=\"#signout()\" style=\"opacity:0\">#</a></h3>\n<p>断开钱包连接</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signOut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h3 id=\"issignedin()\">isSignedIn()<a class=\"index_header-anchor__Xqb+L\" href=\"#issignedin()\" style=\"opacity:0\">#</a></h3>\n<p>判断当前账户是否处于连接中状态</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isSignedIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> boolean<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h3 id=\"getaccountid()\">getAccountId()<a class=\"index_header-anchor__Xqb+L\" href=\"#getaccountid()\" style=\"opacity:0\">#</a></h3>\n<p>获取当前连接的 accountId</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getAccountId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"signMessage\" id=\"signmessage\">signMessage<a class=\"index_header-anchor__Xqb+L\" href=\"#signmessage\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\">near<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">recipient</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">nonce</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Buffer</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Response</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>签名, 示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> message <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'hello world'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">recipient</span><span class=\"token operator\">:</span> <span class=\"token string\">'test.testnet'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">nonce</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4268ebc14ff247f5450d4a8682bec3729a06d268f83b0cb363083ab05b65486b\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"hex\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signMessage</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>返回值示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"accountId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"efad2c...9dae\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"publicKey\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ed25519:H8bbdL...ucKF\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"signature\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"zYbw0Z+YabpZTnYA1REkvAX5KeXt/qRgHkorYfjRR5dD5keySfFuWGMafkfi/RPUpG1EAqbUf9VFt4tTBebcDQ==\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"合约交互\" id=\"合约交互\">合约交互<a class=\"index_header-anchor__Xqb+L\" href=\"#合约交互\" style=\"opacity:0\">#</a></h2>\n<h3 id=\"signandsendtransaction()\">signAndSendTransaction()<a class=\"index_header-anchor__Xqb+L\" href=\"#signandsendtransaction()\" style=\"opacity:0\">#</a></h3>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\">near<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signAndSendTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">receiverId</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">actions</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Action</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Response</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>签名并广播交易, 示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> tx <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">receiverId</span><span class=\"token operator\">:</span> <span class=\"token string\">'wrap.near'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">actions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">methodName</span><span class=\"token operator\">:</span> <span class=\"token string\">'near_deposit'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">args</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">deposit</span><span class=\"token operator\">:</span> <span class=\"token string\">'1250000000000000000000'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signAndSendTransaction</span><span class=\"token punctuation\">(</span>tx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>返回值示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"signAndSendTransaction\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"txHash\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2bNbuT...UdSA\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"code\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>注意: dapp 需要通过 txHash 获取交易广播的结果</p>\n<h3 id=\"requestsigntransactions()\">requestSignTransactions()<a class=\"index_header-anchor__Xqb+L\" href=\"#requestsigntransactions()\" style=\"opacity:0\">#</a></h3>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\">near<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">requestSignTransactions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">transactions</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Transaction</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token maybe-class-name\">Response</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>批量签名交易, 示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> transactions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">receiverId</span><span class=\"token operator\">:</span> <span class=\"token string\">'wrap.near'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">actions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">methodName</span><span class=\"token operator\">:</span> <span class=\"token string\">'near_deposit'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">args</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">deposit</span><span class=\"token operator\">:</span> <span class=\"token string\">'1000000000000000'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">receiverId</span><span class=\"token operator\">:</span> <span class=\"token string\">'wrap.near'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">actions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">methodName</span><span class=\"token operator\">:</span> <span class=\"token string\">'ft_transfer'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">args</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">receiver_id</span><span class=\"token operator\">:</span> <span class=\"token string\">'efad2c...9dae'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token string\">'10000000000'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">deposit</span><span class=\"token operator\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signAndSendTransaction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> transactions <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p>返回值示例:</p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"txs\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"signedTx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"QAAAAG...kAoH\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"txHash\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"71MuUA...KVxt\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"signedTx\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"QAAAAG...gksH\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"txHash\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"8RHzw4...hvLN\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"code\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"requestSignTransactions\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>注意: 批量签名交易钱包只会签名, 不会广播. dapp 侧需要承接广播的逻辑.</p>\n<h2 data-content=\"事件\" id=\"事件\">事件<a class=\"index_header-anchor__Xqb+L\" href=\"#事件\" style=\"opacity:0\">#</a></h2>\n<h3 id=\"signin\">signIn<a class=\"index_header-anchor__Xqb+L\" href=\"#signin\" style=\"opacity:0\">#</a></h3>\n<p>连接钱包成功</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"signIn\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">accountId</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// accountId: 当前连接账户的 accountId</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h3 id=\"signout\">signOut<a class=\"index_header-anchor__Xqb+L\" href=\"#signout\" style=\"opacity:0\">#</a></h3>\n<p>连接钱包成功</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"signIn\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// do something</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h3 id=\"accountchanged\">accountChanged<a class=\"index_header-anchor__Xqb+L\" href=\"#accountchanged\" style=\"opacity:0\">#</a></h3>\n<p>钱包侧切换了账户</p>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">near</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accountChanged\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">accountId</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// accountId: 切换后账户的 accountId</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/chains/near/provider#什么是-injected-provider-api？",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "near",
      "Provider API"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链",
      "TON",
      "Aptos/Movement"
    ],
    "toc": [
      "什么是 Injected provider API？",
      "获取注入的对象",
      "连接钱包",
      "signMessage",
      "合约交互",
      "事件"
    ]
  },
  "word_count": 647,
  "extract_time": "2025-05-27 06:19:17"
}