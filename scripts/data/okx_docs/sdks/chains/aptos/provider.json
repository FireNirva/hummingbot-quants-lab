{
  "title": "Provider API | aptos | 连接浏览器插件钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "Provider API\n#\nAptos-AIP-62\n#\nAIP-62\n标准是Aptos推出的连接钱包的标准，OKX钱包已经支持AIP-62标准.\n什么是 Injected provider API？\n#\n欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。\n连接账户\n#\nwindow.okxwallet.aptos.connect()\n描述\n通过调用\nwindow.okxwallet.aptos.connect()\n连接欧易 Web3 钱包。\n当成功调用\nwindow.okxwallet.aptos.connect()\n，将会唤起欧易 Web3 钱包连接钱包页面，用户可以决定是否连接当前 DApp，如果用户同意将会返回地址 (\naddress\n) 和公钥 (\npublic key\n)。\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nresponse\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nConnect result:\n\"Cannot read properties of undefined (reading 'aptos')\"\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton\n\"\n>\nConnect Aptos\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nresponse\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n}\n)\n;\n获取账户信息\n#\nwindow.okxwallet.aptos.account()\n描述\n调用\nwindow.okxwallet.aptos.account()\n，将会获取当前\nDapp\n链接的账户信息，将会返回地址 (\naddress\n) 和公钥 (\npublic key\n)。\nconst\naccount\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\naccount\n(\n)\n;\n// { address: string, publicKey: string }\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nConnect result:\n\"Cannot read properties of undefined (reading 'aptos')\"\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton\n\"\n>\nConnect Aptos\n</\nbutton\n>\n<\nbutton\nclass\n=\n\"\naccountAptosButton\n\"\n>\nAccount\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nconst\naccountAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.accountAptosButton'\n)\n;\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nresponse\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n}\n)\n;\naccountAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\nconst\naccount\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\naccount\n(\n)\n;\nconsole\n.\nlog\n(\naccount\n)\n;\n// { address: string, publicKey: string }\n}\n)\n;\n获取当前链接的网络\n#\nwindow.okxwallet.aptos.network()\n描述\n调用\nwindow.okxwallet.aptos.network()\n，将会获取当前\nDapp\n链接的网络信息，将会返回链接的网络名称。\nconst\nnetwork\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nnetwork\n(\n)\n;\n// 'Mainnet'\n// 目前支持的网络： `Mainnet` | `Movement Mainnet` | `Movement Testnet`\nenum\nNetwork\n{\nMainnet\n=\n'Mainnet'\nMovementMainnet\n=\n'Movement Mainnet'\nMovementTestnet\n=\n'Movement Testnet'\n}\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nConnect result:\n\"Cannot read properties of undefined (reading 'aptos')\"\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton\n\"\n>\nConnect Aptos\n</\nbutton\n>\n<\nbutton\nclass\n=\n\"\nnetworkAptosButton\n\"\n>\nNetwork\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nconst\nnetworkAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.networkAptosButton'\n)\n;\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nresponse\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n}\n)\n;\nnetworkAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\nconst\nnetwork\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nnetwork\n(\n)\n;\nconsole\n.\nlog\n(\nnetwork\n)\n;\n// 'Mainnet'\n}\n)\n;\n签名交易\n#\nwindow.okxwallet.aptos.signAndSubmitTransaction(transaction)\n描述\n在欧易 Web3 钱包中通过调用\nwindow.okxwallet.aptos.signAndSubmitTransaction(transaction)\n方法来发起一笔 Aptos 链上交易，这个方法将会返回一个待确认的交易信息给 DApp\nconst\ntransaction\n=\n{\narguments\n:\n[\naddress\n,\n'717'\n]\n,\nfunction\n:\n'0x1::coin::transfer'\n,\ntype\n:\n'entry_function_payload'\n,\ntype_arguments\n:\n[\n'0x1::aptos_coin::AptosCoin'\n]\n,\n}\n;\ntry\n{\nconst\npendingTransaction\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nsignAndSubmitTransaction\n(\ntransaction\n)\n;\nconst\nclient\n=\nnew\nAptosClient\n(\n'https://fullnode.mainnet.aptoslabs.com/'\n)\n;\nconst\ntxn\n=\nawait\nclient\n.\nwaitForTransactionWithResult\n(\npendingTransaction\n.\nhash\n,\n)\n;\n}\ncatch\n(\nerror\n)\n{\n// see \"Errors\"\n}\n当然也可以通过\nwindow.okxwallet.aptos.signTransaction(transaction)\n仅仅是签名交易，而不发起上链操作，此方法将返回一个签名的Buffer\n提示\n重要提醒：这个方法并不常用，而且对用户来说也非常的不安全，建议不要使用这个方法\nconst\ntransaction\n=\n{\narguments\n:\n[\naddress\n,\n'717'\n]\n,\nfunction\n:\n'0x1::coin::transfer'\n,\ntype\n:\n'entry_function_payload'\n,\ntype_arguments\n:\n[\n'0x1::aptos_coin::AptosCoin'\n]\n,\n}\n;\ntry\n{\nconst\nsignTransaction\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nsignTransaction\n(\ntransaction\n)\n;\n}\ncatch\n(\nerror\n)\n{\n// see \"Errors\"\n}\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nSend Transaction\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton btn\n\"\n>\nConnect Aptos\n</\nbutton\n>\n<\nbutton\nclass\n=\n\"\nsignTransactionButton btn\n\"\n>\nSign Transaction\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nconst\nsignTransactionButton\n=\ndocument\n.\nquerySelector\n(\n'.signTransactionButton'\n)\n;\nlet\naddress\n=\n''\n;\nsignTransactionButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\ntransaction\n=\n{\narguments\n:\n[\naddress\n,\n'717'\n]\n,\nfunction\n:\n'0x1::coin::transfer'\n,\ntype\n:\n'entry_function_payload'\n,\ntype_arguments\n:\n[\n'0x1::aptos_coin::AptosCoin'\n]\n,\n}\n;\nconst\npendingTransaction\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nsignAndSubmitTransaction\n(\ntransaction\n)\n;\nconsole\n.\nlog\n(\npendingTransaction\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n}\n}\n)\n;\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\nconsole\n.\nlog\n(\nres\n)\n;\nconst\nres\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\naddress\n=\nres\n.\naddress\n;\n}\n)\n;\n签名信息\n#\nwindow.okxwallet.aptos.signMessage(message)\n描述\nDApp 可以通过调用\nwindow.okxwallet.aptos.signMessage(message)\n来签名一段消息，当用户同意这个操作后，欧易 Web3 钱包将返回签名成功的信息、签名信息、入参和返回信息。结构如下：\n参数\ninterface\nSignMessagePayload\n{\naddress\n?\n:\nboolean\n;\n// Should we include the address of the account in the message\napplication\n?\n:\nboolean\n;\n// Should we include the domain of the DApp\nchainId\n?\n:\nboolean\n;\n// Should we include the current chain id the wallet is connected to\nmessage\n:\nstring\n;\n// The message to be signed and displayed to the user\nnonce\n:\nstring\n;\n// A nonce the DApp should generate\n}\n返回值\ninterface\nSignMessageResponse\n{\naddress\n:\nstring\n;\napplication\n:\nstring\n;\nchainId\n:\nnumber\n;\nfullMessage\n:\nstring\n;\n// The message that was generated to sign\nmessage\n:\nstring\n;\n// The message passed in by the user\nnonce\n:\nstring\n;\nprefix\n:\nstring\n;\n// Should always be APTOS\nsignature\n:\nstring\n;\n// The signed full message\n}\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nSign Message\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton btn\n\"\n>\nConnect Aptos\n</\nbutton\n>\n<\nbutton\nclass\n=\n\"\nsignButton btn\n\"\n>\nSign Message\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nconst\nsignButton\n=\ndocument\n.\nquerySelector\n(\n'.signButton'\n)\n;\nconst\nsignMessagePayload\n=\n{\nmessage\n:\n'hello okx'\n,\nnonce\n:\n'okx'\n}\n;\nsignButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\nsignMessage\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nsignMessage\n(\nsignMessagePayload\n)\nconsole\n.\nlog\n(\nsignMessage\n)\n;\n// {\"signature\": string, \"prefix\": \"APTOS\", \"fullMessage\": \"APTOS nonce: okx message: hello okx\", \"message\": \"hello okx\", \"nonce\": \"okx\" }\n}\ncatch\n(\nerror\n)\n{\n// see \"Errors\"\n}\n}\n)\n;\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\n(\n)\n=>\n{\nconnetAccount\n(\n)\n;\n}\n)\n;\nasync\nfunction\nconnetAccount\n(\n)\n{\nconst\nres\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nres\n)\n;\n}\n签名消息验证\n#\nimport\nnacl\nfrom\n'tweetnacl'\n;\nconst\nmessage\n=\n'hello'\n;\nconst\nnonce\n=\n'random_string'\n;\ntry\n{\nconst\nresponse\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nsignMessage\n(\n{\nmessage\n,\nnonce\n,\n}\n)\n;\nconst\n{\npublicKey\n}\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\naccount\n(\n)\n;\n// Remove the 0x prefix\nconst\nkey\n=\npublicKey\n!\n.\nslice\n(\n2\n,\n66\n)\n;\nconst\nverified\n=\nnacl\n.\nsign\n.\ndetached\n.\nverify\n(\nBuffer\n.\nfrom\n(\nresponse\n.\nfullMessage\n)\n,\nBuffer\n.\nfrom\n(\nresponse\n.\nsignature\n,\n'hex'\n)\n,\nBuffer\n.\nfrom\n(\nkey\n,\n'hex'\n)\n,\n)\n;\nconsole\n.\nlog\n(\nverified\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nerror\n(\nerror\n)\n;\n}\n事件\n#\n账户切换\n当用户在切换欧易 Web3 钱包的时候，需要监听钱包切换事件：\nonAccountChange\n提示\n重要提醒：用户切换的钱包的时候，目前账户必须有\nAptos\n地址时才会触发。\nlet\ncurrentAccount\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\naccount\n(\n)\n;\n// event listener for disconnecting\nwindow\n.\nokxwallet\n.\naptos\n.\nonAccountChange\n(\n(\nnewAccount\n)\n=>\n{\n// If the new account has already connected to your app then the newAccount will be returned\nif\n(\nnewAccount\n)\n{\ncurrentAccount\n=\nnewAccount\n;\n}\nelse\n{\n// Otherwise you will need to ask to connect to the new account\ncurrentAccount\n=\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\n}\n}\n)\n;\nonNetworkChange()\nDApp 需要确保用户链接的是目标网络，因此需要获取当前网络、切换网络以及网络切换监听。\n// 当前dapp链接的网络\nlet\nnetwork\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nnetwork\n(\n)\n;\n// 监听链接的网络发生变化\nwindow\n.\nbitkeep\n.\naptos\n.\nonNetworkChange\n(\n(\nnewNetwork\n)\n=>\n{\nnetwork\n=\nnewNetwork\n;\n// { networkName: 'Mainnet' }\n}\n)\n;\n断开连接\n当欧易 Web3 钱包断开连接的时候（欧易 Web3 钱包是多链钱包，当用户切换到的钱包不包含\nAptos\n相关地址的时候，也会触发该事件）\n// get current connection status\nlet\nconnectionStatus\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nisConnected\n(\n)\n;\n// event listener for disconnecting\nwindow\n.\nokxwallet\n.\naptos\n.\nonDisconnect\n(\n(\n)\n=>\n{\nconnectionStatus\n=\nfalse\n;\n}\n)\n;\n例子\n在\ncodeopen\n中打开。\nConnect Aptos\nConnect result:\n\"Cannot read properties of undefined (reading 'aptos')\"\nHTML\nJavaScript\n<\nbutton\nclass\n=\n\"\nconnectAptosButton\n\"\n>\nConnect Aptos\n</\nbutton\n>\nconst\nconnectAptosButton\n=\ndocument\n.\nquerySelector\n(\n'.connectAptosButton'\n)\n;\nwindow\n.\nokxwallet\n.\naptos\n.\non\n(\n'connect'\n,\n(\n)\n=>\n{\nconsole\n.\nlog\n(\n'got connect event'\n)\n;\n}\n)\nconnectAptosButton\n.\naddEventListener\n(\n'click'\n,\nasync\n(\n)\n=>\n{\ntry\n{\nconst\nres\n=\nawait\nwindow\n.\nokxwallet\n.\naptos\n.\nconnect\n(\n)\n;\nconsole\n.\nlog\n(\nres\n)\n;\n// { address: string, publicKey: string }\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n// { code: 4001, message: \"User rejected the request.\"}\n}\n}\n)\n;",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"provider-api\">Provider API<a class=\"index_header-anchor__Xqb+L\" href=\"#provider-api\" style=\"opacity:0\">#</a></h1>\n<h2 data-content=\"Aptos-AIP-62\" id=\"aptos-aip-62\">Aptos-AIP-62<a class=\"index_header-anchor__Xqb+L\" href=\"#aptos-aip-62\" style=\"opacity:0\">#</a></h2>\n<p><a class=\"items-center\" href=\"https://aptos.dev/en/build/sdks/wallet-adapter/wallets\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">AIP-62<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>标准是Aptos推出的连接钱包的标准，OKX钱包已经支持AIP-62标准.</p>\n<h2 data-content=\"什么是 Injected provider API？\" id=\"什么是-injected-provider-api？\">什么是 Injected provider API？<a class=\"index_header-anchor__Xqb+L\" href=\"#什么是-injected-provider-api？\" style=\"opacity:0\">#</a></h2>\n<p>欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。</p>\n<h2 data-content=\"连接账户\" id=\"连接账户\">连接账户<a class=\"index_header-anchor__Xqb+L\" href=\"#连接账户\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.aptos.connect()</code></p>\n<p><strong>描述</strong></p>\n<p>通过调用 <code>window.okxwallet.aptos.connect()</code> 连接欧易 Web3 钱包。</p>\n<p>当成功调用 <code>window.okxwallet.aptos.connect()</code>，将会唤起欧易 Web3 钱包连接钱包页面，用户可以决定是否连接当前 DApp，如果用户同意将会返回地址 (<code>address</code>) 和公钥 (<code>public key</code>)。</p>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/okxwallet/pen/NWLbxKx\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><div class=\"feedback-wrapper\"><strong>Connect result: </strong><span style=\"font-family: monospace;\">\"Cannot read properties of undefined (reading 'aptos')\"</span></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":Rtbf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":Rtbf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":Rtbf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":Rtbf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div></div></div></div>\n<h2 data-content=\"获取账户信息\" id=\"获取账户信息\">获取账户信息<a class=\"index_header-anchor__Xqb+L\" href=\"#获取账户信息\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.aptos.account()</code></p>\n<p><strong>描述</strong></p>\n<p>调用 <code>window.okxwallet.aptos.account()</code>，将会获取当前 <code>Dapp</code> 链接的账户信息，将会返回地址 (<code>address</code>) 和公钥 (<code>public key</code>)。</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> account <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">account</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// { address: string, publicKey: string }</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/lsbwfyzl-the-reactor/pen/QWXpgZo\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><div class=\"feedback-wrapper\"><strong>Connect result: </strong><span style=\"font-family: monospace;\">\"Cannot read properties of undefined (reading 'aptos')\"</span></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":R1fbf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":R1fbf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":R1fbf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>accountAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Account<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":R1fbf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> accountAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.accountAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\naccountAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> account <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">account</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// { address: string, publicKey: string }</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre></div></div></div></div>\n<h2 data-content=\"获取当前链接的网络\" id=\"获取当前链接的网络\">获取当前链接的网络<a class=\"index_header-anchor__Xqb+L\" href=\"#获取当前链接的网络\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.aptos.network()</code></p>\n<p><strong>描述</strong></p>\n<p>调用 <code>window.okxwallet.aptos.network()</code>，将会获取当前 <code>Dapp</code> 链接的网络信息，将会返回链接的网络名称。</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> network <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">network</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 'Mainnet'</span>\n</code></pre></div>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 目前支持的网络： `Mainnet` | `Movement Mainnet` | `Movement Testnet`</span>\n<span class=\"token keyword\">enum</span> Network <span class=\"token punctuation\">{</span>\n  Mainnet <span class=\"token operator\">=</span> <span class=\"token string\">'Mainnet'</span>\n  MovementMainnet <span class=\"token operator\">=</span> <span class=\"token string\">'Movement Mainnet'</span>\n  MovementTestnet <span class=\"token operator\">=</span> <span class=\"token string\">'Movement Testnet'</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/lsbwfyzl-the-reactor/pen/dyBvzGJ\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><div class=\"feedback-wrapper\"><strong>Connect result: </strong><span style=\"font-family: monospace;\">\"Cannot read properties of undefined (reading 'aptos')\"</span></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":R23bf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":R23bf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":R23bf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>networkAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Network<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":R23bf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> networkAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.networkAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\nnetworkAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> network <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">network</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>network<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 'Mainnet'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre></div></div></div></div>\n<h2 data-content=\"签名交易\" id=\"签名交易\">签名交易<a class=\"index_header-anchor__Xqb+L\" href=\"#签名交易\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.aptos.signAndSubmitTransaction(transaction)</code></p>\n<p><strong>描述</strong></p>\n<p>在欧易 Web3 钱包中通过调用 <code>window.okxwallet.aptos.signAndSubmitTransaction(transaction)</code> 方法来发起一笔 Aptos 链上交易，这个方法将会返回一个待确认的交易信息给 DApp</p>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> transaction <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>address<span class=\"token punctuation\">,</span> <span class=\"token string\">'717'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x1::coin::transfer'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'entry_function_payload'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">type_arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'0x1::aptos_coin::AptosCoin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> pendingTransaction <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signAndSubmitTransaction</span><span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AptosClient</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://fullnode.mainnet.aptoslabs.com/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> txn <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">waitForTransactionWithResult</span><span class=\"token punctuation\">(</span>\n      pendingTransaction<span class=\"token punctuation\">.</span><span class=\"token property-access\">hash</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// see \"Errors\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>当然也可以通过 <code>window.okxwallet.aptos.signTransaction(transaction)</code> 仅仅是签名交易，而不发起上链操作，此方法将返回一个签名的Buffer</p>\n<div class=\"index_wrapper__x5A2Q\"><div aria-labelledby=\":R2hbf:\" class=\"okui-alert info-alert\"><i aria-hidden=\"true\" class=\"icon iconfont okui-alert-icon doc-ssr-okds-information-circle-fill\" role=\"img\"></i><div class=\"okui-alert-msg-box\"><div class=\"okui-alert-title\" id=\":R2hbf:\">提示</div><div class=\"okui-alert-desc\"><div class=\"index_desc__5fNBE\">重要提醒：这个方法并不常用，而且对用户来说也非常的不安全，建议不要使用这个方法</div></div></div></div></div>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> transaction <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>address<span class=\"token punctuation\">,</span> <span class=\"token string\">'717'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword\">function</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x1::coin::transfer'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'entry_function_payload'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">type_arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'0x1::aptos_coin::AptosCoin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> signTransaction <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signTransaction</span><span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// see \"Errors\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/okxwallet/pen/qBMqbbJ\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div class=\"interact-wrapper\"><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><button class=\"okui-btn btn-md btn-outline-primary\" style=\"margin-left:14px\" type=\"button\"><span class=\"btn-content\">Send Transaction</span></button><div class=\"feedback-wrapper\"></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":R2rbf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":R2rbf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":R2rbf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>signTransactionButton btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Sign Transaction<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":R2rbf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> signTransactionButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.signTransactionButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> address<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n\nsignTransactionButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> transaction <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>address<span class=\"token punctuation\">,</span> <span class=\"token string\">'717'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">function</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x1::coin::transfer'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'entry_function_payload'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">type_arguments</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'0x1::aptos_coin::AptosCoin'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> pendingTransaction <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signAndSubmitTransaction</span><span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>pendingTransaction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   address <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span><span class=\"token property-access\">address</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div></div></div></div>\n<h2 data-content=\"签名信息\" id=\"签名信息\">签名信息<a class=\"index_header-anchor__Xqb+L\" href=\"#签名信息\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.aptos.signMessage(message)</code></p>\n<p><strong>描述</strong></p>\n<p>DApp 可以通过调用 <code>window.okxwallet.aptos.signMessage(message)</code> 来签名一段消息，当用户同意这个操作后，欧易 Web3 钱包将返回签名成功的信息、签名信息、入参和返回信息。结构如下：</p>\n<p><strong>参数</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">SignMessagePayload</span> <span class=\"token punctuation\">{</span>\n  address<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Should we include the address of the account in the message</span>\n  application<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Should we include the domain of the DApp</span>\n  chainId<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Should we include the current chain id the wallet is connected to</span>\n  message<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// The message to be signed and displayed to the user</span>\n  nonce<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// A nonce the DApp should generate</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>返回值</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">SignMessageResponse</span> <span class=\"token punctuation\">{</span>\n  address<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  application<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  chainId<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  fullMessage<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// The message that was generated to sign</span>\n  message<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// The message passed in by the user</span>\n  nonce<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  prefix<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Should always be APTOS</span>\n  signature<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// The signed full message</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/okxwallet/pen/RwYorBP\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div class=\"interact-wrapper\"><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><button class=\"okui-btn btn-md btn-outline-primary\" style=\"margin-left:14px\" type=\"button\"><span class=\"btn-content\">Sign Message</span></button><div class=\"feedback-wrapper\"></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":R3jbf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":R3jbf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":R3jbf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>signButton btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Sign Message<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":R3jbf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> signButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.signButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> signMessagePayload <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">message</span><span class=\"token operator\">:</span> <span class=\"token string\">'hello okx'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">nonce</span><span class=\"token operator\">:</span> <span class=\"token string\">'okx'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nsignButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> signMessage <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signMessage</span><span class=\"token punctuation\">(</span>signMessagePayload<span class=\"token punctuation\">)</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>signMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// {\"signature\": string, \"prefix\": \"APTOS\", \"fullMessage\": \"APTOS nonce: okx message: hello okx\", \"message\": \"hello okx\", \"nonce\": \"okx\" }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// see \"Errors\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">connetAccount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">connetAccount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div></div></div></div>\n<h2 data-content=\"签名消息验证\" id=\"签名消息验证\">签名消息验证<a class=\"index_header-anchor__Xqb+L\" href=\"#签名消息验证\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword module\">import</span> <span class=\"token imports\">nacl</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'tweetnacl'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> message <span class=\"token operator\">=</span> <span class=\"token string\">'hello'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> nonce <span class=\"token operator\">=</span> <span class=\"token string\">'random_string'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        message<span class=\"token punctuation\">,</span>\n        nonce<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> publicKey <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">account</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Remove the 0x prefix</span>\n    <span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> publicKey<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">66</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> verified <span class=\"token operator\">=</span> nacl<span class=\"token punctuation\">.</span><span class=\"token property-access\">sign</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">detached</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">verify</span><span class=\"token punctuation\">(</span>\n        <span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">from</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token property-access\">fullMessage</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">from</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token property-access\">signature</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token maybe-class-name\">Buffer</span><span class=\"token punctuation\">.</span><span class=\"token keyword module\">from</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>verified<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"事件\" id=\"事件\">事件<a class=\"index_header-anchor__Xqb+L\" href=\"#事件\" style=\"opacity:0\">#</a></h2>\n<p><strong>账户切换</strong></p>\n<p>当用户在切换欧易 Web3 钱包的时候，需要监听钱包切换事件：<code>onAccountChange</code></p>\n<div class=\"index_wrapper__x5A2Q\"><div aria-labelledby=\":R3vbf:\" class=\"okui-alert info-alert\"><i aria-hidden=\"true\" class=\"icon iconfont okui-alert-icon doc-ssr-okds-information-circle-fill\" role=\"img\"></i><div class=\"okui-alert-msg-box\"><div class=\"okui-alert-title\" id=\":R3vbf:\">提示</div><div class=\"okui-alert-desc\"><div class=\"index_desc__5fNBE\">重要提醒：用户切换的钱包的时候，目前账户必须有 <code>Aptos</code> 地址时才会触发。</div></div></div></div></div>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">let</span> currentAccount <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">account</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// event listener for disconnecting</span>\nwindow<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">onAccountChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>newAccount<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// If the new account has already connected to your app then the newAccount will be returned</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>newAccount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    currentAccount <span class=\"token operator\">=</span> newAccount<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Otherwise you will need to ask to connect to the new account</span>\n    currentAccount <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><strong>onNetworkChange()</strong></p>\n<p>DApp 需要确保用户链接的是目标网络，因此需要获取当前网络、切换网络以及网络切换监听。</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 当前dapp链接的网络</span>\n<span class=\"token keyword\">let</span> network <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">network</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 监听链接的网络发生变化</span>\nwindow<span class=\"token punctuation\">.</span>bitkeep<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">onNetworkChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>newNetwork<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  network <span class=\"token operator\">=</span> newNetwork<span class=\"token punctuation\">;</span> <span class=\"token comment\">// { networkName: 'Mainnet' }</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><strong>断开连接</strong></p>\n<p>当欧易 Web3 钱包断开连接的时候（欧易 Web3 钱包是多链钱包，当用户切换到的钱包不包含 <code>Aptos</code> 相关地址的时候，也会触发该事件）</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// get current connection status</span>\n<span class=\"token keyword\">let</span> connectionStatus <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> window<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">isConnected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// event listener for disconnecting</span>\nwindow<span class=\"token punctuation\">.</span>okxwallet<span class=\"token punctuation\">.</span>aptos<span class=\"token punctuation\">.</span><span class=\"token function\">onDisconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  connectionStatus <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<p><strong>例子</strong></p>\n<p>在 <a class=\"items-center\" href=\"https://codepen.io/okxwallet/pen/PodbZEN\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">codeopen<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a>中打开。</p>\n<div><button class=\"okui-btn btn-md btn-fill-highlight\" type=\"button\"><span class=\"btn-content\">Connect Aptos</span></button><div class=\"feedback-wrapper\"><strong>Connect result: </strong><span style=\"font-family: monospace;\">\"Cannot read properties of undefined (reading 'aptos')\"</span></div></div>\n<div class=\"okui-tabs\" style=\"height:auto;margin-top:14px\"><div class=\"okui-tabs-pane-list okui-tabs-pane-list-md okui-tabs-pane-list-blue okui-tabs-pane-list-underline\"><div class=\"okui-tabs-pane-list-wrapper underline-special-style\"><div class=\"okui-tabs-pane-list-container\" role=\"tablist\"><div class=\"okui-tabs-pane-list-flex-shrink\"><div aria-selected=\"true\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline okui-tabs-pane-underline-active\" data-pane-id=\"HTML\" id=\":R4lbf:-HTML\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"0\">HTML</div><div aria-selected=\"false\" class=\"okui-tabs-pane okui-tabs-pane-spacing okui-tabs-pane-md okui-tabs-pane-blue okui-tabs-pane-underline\" data-pane-id=\"JavaScript\" id=\":R4lbf:-JavaScript\" role=\"tab\" style=\"--okd-inner-tabs-spacing:8px\" tabindex=\"-1\">JavaScript</div></div></div></div></div><div class=\"okui-tabs-panel-list\"><div aria-hidden=\"false\" aria-labelledby=\":R4lbf:-HTML\" class=\"okui-tabs-panel okui-tabs-panel-show\" role=\"tabpanel\" tabindex=\"0\"><div class=\"remark-highlight\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>connectAptosButton<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Connect Aptos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre></div></div><div aria-hidden=\"true\" aria-labelledby=\":R4lbf:-JavaScript\" class=\"okui-tabs-panel\" role=\"tabpanel\" tabindex=\"-1\"><div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> connectAptosButton <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.connectAptosButton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'connect'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token arrow operator\">=&gt;</span><span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'got connect event'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nconnectAptosButton<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">aptos</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { address: string, publicKey: string }</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// { code: 4001, message: \"User rejected the request.\"}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div></div></div></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/chains/aptos/provider#连接账户",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "aptos",
      "Provider API"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链",
      "TON",
      "Aptos/Movement"
    ],
    "toc": [
      "Aptos-AIP-62",
      "什么是 Injected provider API？",
      "连接账户",
      "获取账户信息",
      "获取当前链接的网络",
      "签名交易",
      "签名信息",
      "签名消息验证",
      "事件"
    ]
  },
  "word_count": 1764,
  "extract_time": "2025-05-27 07:11:21"
}