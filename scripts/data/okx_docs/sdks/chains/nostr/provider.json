{
  "title": "Provider API | nostr | 连接浏览器插件钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "Provider API\n#\n什么是 Injected provider API？\n#\n欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。\n获取注入的对象\n#\nDapp 可以通过如下方式访问注入的对象：\nwindow.okxwallet.nostr\n连接钱包的简单示例\n#\ntry\n{\nconst\npublicKey\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\ngetPublicKey\n(\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n}\n获取公钥\n#\nwindow.okxwallet.nostr.getPublicKey(): Promise<string>\n描述\n返回当前连接的帐户的公钥。\n返回值\npublicKey\n- string: 当前连接的帐户的公钥。\ntry\n{\nconst\npublicKey\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\ngetPublicKey\n(\n)\n;\n}\ncatch\n(\nerror\n)\n{\nconsole\n.\nlog\n(\nerror\n)\n;\n}\n签名 Event\n#\nwindow.okxwallet.nostr.signEvent(event: Event): Promise<SignedEvent>\n描述\n对 Event 进行签名。\n入参\nevent\n- object\ncreated_at\n- number: 事件创建时间\nkind\n- number: 事件类型\ntags\n- string[][]: 事件标签\ncontent\n- string: 事件内容\n返回值\nevent\n- SignedEvent：除了包含 event 入参的所有属性外，还包含如下属性\nid\n- string: 唯一标识\npubkey\n- string: 公钥\nsig\n- string: 签名\nconst\nevent\n=\n{\ncontent\n:\n\"hello\"\n,\nkind\n:\n4\n,\n\"tags\"\n:\n[\n[\n\"p\"\n,\n\"693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8\"\n]\n,\n[\n\"r\"\n,\n\"json\"\n]\n,\n[\n\"a\"\n,\n\"b4f4e689fca78ebcaeec72162628ba61c51a62e1420b9b8ca8cb63d9a7e26219\"\n]\n]\n,\n\"created_at\"\n:\n1700726837\n,\n}\nconst\nsignedEvent\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\nsignEvent\n(\nevent\n)\nconsole\n.\nlog\n(\nsignedEvent\n.\nid\n)\nconsole\n.\nlog\n(\nsignedEvent\n.\npubkey\n)\nconsole\n.\nlog\n(\nsignedEvent\n.\nsig\n)\n对消息进行加密\n#\nwindow.okxwallet.nostr.nip04.encrypt(pubkey: string, message: string): Promise<string>\n描述\n根据\nNIP-04\n规范对消息进行加密\n返回值\nencryptMsg\n- string: 加密的结果\nconst\npubkey\n=\n'693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8'\nconst\nmsg\n=\n'hello world'\nconst\nencryptMsg\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\nnip04\n.\nencrypt\n(\npubkey\n,\nmsg\n)\n;\nconsole\n.\nlog\n(\nencryptMsg\n)\n对消息进行解密\n#\nwindow.okxwallet.nostr.nip04.decrypt(pubkey: string, message: string): Promise<string>\n描述\n根据\nNIP-04\n规范对消息进行解密\n返回值\ndecryptMsg\n- string: 解密的结果\nconst\npubkey\n=\n'693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8'\nconst\nmsg\n=\n'VVPplRPF0w4dNZkuiQ==?iv=Nrb7gcph/9eKuqyuDx0yKQ=='\nconst\ndecryptMsg\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\nnip04\n.\ndecrypt\n(\npubkey\n,\nmsg\n)\n;\nconsole\n.\nlog\n(\ndecryptMsg\n)\n添加/移除事件监听\n#\nwindow.okxwallet.nostr.on(event:string, callback: Function): Promise<void>\nwindow.okxwallet.nostr.off(event:string, callback: Function): Promise<void>\n描述\n添加事件监听，目前支持的事件有：\naccountChanged\n：当用户切换账户时会触发该事件\nwindow\n.\nokxwallet\n.\nnostr\n.\non\n(\n'accountChanged'\n,\nasync\n(\n)\n=>\n{\nconst\npublicKey\n=\nawait\nwindow\n.\nokxwallet\n.\nnostr\n.\ngetPublicKey\n(\n)\n;\nconsole\n.\nlog\n(\npublicKey\n)\n}\n)",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"provider-api\">Provider API<a class=\"index_header-anchor__Xqb+L\" href=\"#provider-api\" style=\"opacity:0\">#</a></h1>\n<h2 data-content=\"什么是 Injected provider API？\" id=\"什么是-injected-provider-api？\">什么是 Injected provider API？<a class=\"index_header-anchor__Xqb+L\" href=\"#什么是-injected-provider-api？\" style=\"opacity:0\">#</a></h2>\n<p>欧易 Injected providers API 是一个 JavaScript API，欧易将其注入用户访问的网站。您的 DApp 可以使用此 API 请求用户帐户，从用户连接的区块链读取数据，帮助用户签署消息和交易。</p>\n<h2 data-content=\"获取注入的对象\" id=\"获取注入的对象\">获取注入的对象<a class=\"index_header-anchor__Xqb+L\" href=\"#获取注入的对象\" style=\"opacity:0\">#</a></h2>\n<p>Dapp 可以通过如下方式访问注入的对象：</p>\n<ul>\n<li><code>window.okxwallet.nostr</code></li>\n</ul>\n<h2 data-content=\"连接钱包的简单示例\" id=\"连接钱包的简单示例\">连接钱包的简单示例<a class=\"index_header-anchor__Xqb+L\" href=\"#连接钱包的简单示例\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getPublicKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"获取公钥\" id=\"获取公钥\">获取公钥<a class=\"index_header-anchor__Xqb+L\" href=\"#获取公钥\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.nostr.getPublicKey(): Promise&lt;string&gt;</code></p>\n<p><strong>描述</strong></p>\n<p>返回当前连接的帐户的公钥。</p>\n<p><strong>返回值</strong></p>\n<ul>\n<li><code>publicKey</code> - string: 当前连接的帐户的公钥。</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getPublicKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h2 data-content=\"签名 Event\" id=\"签名-event\">签名 Event<a class=\"index_header-anchor__Xqb+L\" href=\"#签名-event\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.nostr.signEvent(event: Event): Promise&lt;SignedEvent&gt;</code></p>\n<p><strong>描述</strong></p>\n<p>对 Event 进行签名。</p>\n<p><strong>入参</strong></p>\n<ul>\n<li><code>event</code> - object<!-- -->\n<ul>\n<li><code>created_at</code> - number: 事件创建时间</li>\n<li><code>kind</code> - number: 事件类型</li>\n<li><code>tags</code> - string[][]: 事件标签</li>\n<li><code>content</code> - string: 事件内容</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li><code>event</code> - SignedEvent：除了包含 event 入参的所有属性外，还包含如下属性<!-- -->\n<ul>\n<li><code>id</code> - string: 唯一标识</li>\n<li><code>pubkey</code> - string: 公钥</li>\n<li><code>sig</code> - string: 签名</li>\n</ul>\n</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> event <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">kind</span><span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"tags\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"p\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8\"</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"json\"</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"b4f4e689fca78ebcaeec72162628ba61c51a62e1420b9b8ca8cb63d9a7e26219\"</span>\n        <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"created_at\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1700726837</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> signedEvent <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">signEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>signedEvent<span class=\"token punctuation\">.</span><span class=\"token property-access\">id</span><span class=\"token punctuation\">)</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>signedEvent<span class=\"token punctuation\">.</span><span class=\"token property-access\">pubkey</span><span class=\"token punctuation\">)</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>signedEvent<span class=\"token punctuation\">.</span><span class=\"token property-access\">sig</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"对消息进行加密\" id=\"对消息进行加密\">对消息进行加密<a class=\"index_header-anchor__Xqb+L\" href=\"#对消息进行加密\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.nostr.nip04.encrypt(pubkey: string, message: string): Promise&lt;string&gt;</code></p>\n<p><strong>描述</strong></p>\n<p>根据 <a class=\"items-center\" href=\"https://github.com/nostr-protocol/nips/blob/master/04.md\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">NIP-04<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a> 规范对消息进行加密</p>\n<p><strong>返回值</strong></p>\n<ul>\n<li><code>encryptMsg</code> - string: 加密的结果</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> pubkey <span class=\"token operator\">=</span> <span class=\"token string\">'693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8'</span>\n<span class=\"token keyword\">const</span> msg <span class=\"token operator\">=</span> <span class=\"token string\">'hello world'</span>\n<span class=\"token keyword\">const</span> encryptMsg <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nip04</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">encrypt</span><span class=\"token punctuation\">(</span>pubkey<span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>encryptMsg<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"对消息进行解密\" id=\"对消息进行解密\">对消息进行解密<a class=\"index_header-anchor__Xqb+L\" href=\"#对消息进行解密\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.nostr.nip04.decrypt(pubkey: string, message: string): Promise&lt;string&gt;</code></p>\n<p><strong>描述</strong></p>\n<p>根据 <a class=\"items-center\" href=\"https://github.com/nostr-protocol/nips/blob/master/04.md\" rel=\"nofollow noreferrer\" style=\"display:inline-flex;line-height:16px\" target=\"_blank\">NIP-04<i aria-hidden=\"true\" class=\"icon iconfont doc-ssr-okds-open-link\" role=\"img\" style=\"font-size:24px;color:#0569FF;margin-left:2px\"></i></a> 规范对消息进行解密</p>\n<p><strong>返回值</strong></p>\n<ul>\n<li><code>decryptMsg</code> - string: 解密的结果</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> pubkey <span class=\"token operator\">=</span> <span class=\"token string\">'693d3f45b81c1f3557383fb955f3a8cb2c194c44ffba1e2f4566e678773b44f8'</span>\n<span class=\"token keyword\">const</span> msg <span class=\"token operator\">=</span> <span class=\"token string\">'VVPplRPF0w4dNZkuiQ==?iv=Nrb7gcph/9eKuqyuDx0yKQ=='</span>\n<span class=\"token keyword\">const</span> decryptMsg <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nip04</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">decrypt</span><span class=\"token punctuation\">(</span>pubkey<span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>decryptMsg<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"添加/移除事件监听\" id=\"添加/移除事件监听\">添加/移除事件监听<a class=\"index_header-anchor__Xqb+L\" href=\"#添加/移除事件监听\" style=\"opacity:0\">#</a></h2>\n<p><code>window.okxwallet.nostr.on(event:string, callback: Function): Promise&lt;void&gt;</code></p>\n<p><code>window.okxwallet.nostr.off(event:string, callback: Function): Promise&lt;void&gt;</code></p>\n<p><strong>描述</strong></p>\n<p>添加事件监听，目前支持的事件有：</p>\n<ul>\n<li><code>accountChanged</code>：当用户切换账户时会触发该事件</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'accountChanged'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> publicKey <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">okxwallet</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">nostr</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getPublicKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>publicKey<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/chains/nostr/provider#连接钱包的简单示例",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "nostr",
      "Provider API"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链",
      "TON",
      "Aptos/Movement"
    ],
    "toc": [
      "什么是 Injected provider API？",
      "获取注入的对象",
      "连接钱包的简单示例",
      "获取公钥",
      "签名 Event",
      "对消息进行加密",
      "对消息进行解密",
      "添加/移除事件监听"
    ]
  },
  "word_count": 372,
  "extract_time": "2025-05-27 05:50:35"
}