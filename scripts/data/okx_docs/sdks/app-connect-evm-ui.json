{
  "title": "UI | EVM兼容链 | 连接App或Mini钱包 | 接入 Web3 钱包 | DEX API 文档 | 欧易",
  "text": "UI\n#\n在 SDK 的基础上，我们也提供了 UI 界面。如果选择通过UI接入，若DApp运行在 Telegram内，则用户可以选择唤起欧易 App 钱包或者停留在Telegram并唤起欧易 Telegram Mini 钱包。\n通过npm安装\n#\nnpm install @okxconnect/ui\n初始化\n#\n连接钱包之前，需要先创建一个对象，用于后续连接钱包、发送交易等操作。\nOKXUniversalConnectUI.init(DAppMetaData, actionsConfiguration, uiPreferences, language, restoreConnection)\n请求参数\nDAppMetaData - object\nname - string: 应用名称，不会作为唯一表示\nicon - string: 应用图标的 URL。必须是 PNG、ICO 等格式，不支持 SVG 图标。最好传递指向 180x180px PNG 图标的 url。\nactionsConfiguration - object\nmodals - ('before' | 'success' | 'error')[] | 'all' 交易过程中的提醒界面展示模式，默认为'before'\nreturnStrategy -string 'none' |\n${string}://${string}\n; 针对app 钱包，指定当用户签署/拒绝请求时深层链接的返回策略，如果是在telegram中，可以配置tg://resolve；\ntmaReturnUrl -string 'back' | 'none' |\n${string}://${string}\n; Telegram Mini Wallet 钱包中，用户签署/拒绝请求时深层链接的返回策略，一般配置back,表示签名后关闭钱包，会自动展示出DApp；none 表示签名后不做处理；默认为back；\nuiPreferences -object\ntheme - Theme 可以是：THEME.DARK, THEME.LIGHT, \"SYSTEM\"\nlanguage - \"en_US\" | \"ru_RU\" | \"zh_CN\" | \"ar_AE\" | \"cs_CZ\" | \"de_DE\" | \"es_ES\" | \"es_LAT\" | \"fr_FR\" | \"id_ID\" | \"it_IT\" | \"nl_NL\" | \"pl_PL\" | \"pt_BR\" | \"pt_PT\" | \"ro_RO\" | \"tr_TR\" | \"uk_UA\" | \"vi_VN\";\n, 默认为en_US\nrestoreConnection?: boolean - 是否自动回复之前的连接；\n返回值\nOKXUniversalConnectUI\n示例\nimport\n{\nOKXUniversalConnectUI\n}\nfrom\n\"@okxconnect/ui\"\n;\nconst\nuniversalUi\n=\nawait\nOKXUniversalConnectUI\n.\ninit\n(\n{\nDAppMetaData\n:\n{\nicon\n:\n\"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png\"\n,\nname\n:\n\"OKX Connect Demo\"\n}\n,\nactionsConfiguration\n:\n{\nreturnStrategy\n:\n'tg://resolve'\n,\nmodals\n:\n'all'\n,\ntmaReturnUrl\n:\n'back'\n}\n,\nlanguage\n:\n\"en_US\"\n,\nuiPreferences\n:\n{\ntheme\n:\nTHEME\n.\nLIGHT\n}\n,\n}\n)\n;\n// 连接OKX插件钱包后，切换插件钱包，会触发该事件；\nuniversalUi\n.\non\n(\n\"accountChanged\"\n,\n(\nsession\n)\n=>\n{\nif\n(\nsession\n)\n{\nconsole\n.\nlog\n(\n`\naccountChanged\n`\n,\nJSON\n.\nstringify\n(\nsession\n)\n)\n;\n}\n}\n)\n;\n连接钱包\n#\n连接钱包去获取钱包地址，作为标识符和用于签名交易的必要参数，\nawait universalUi.openModal(connectParams: ConnectParams);\n请求参数\nconnectParams - ConnectParams\nnamespaces - [namespace: string]: ConnectNamespace ; 请求连接的必要信息， EVM系的key为\"eip155\"\n，如果请求的链中，有任何一个链钱包不支持的话，钱包会拒绝连接；\nchains: string[]; 链id信息，EIP155中定义的十进制数字，比如以太坊是eip155:1,\ndefaultChain?: string; 默认链\nrpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；\noptionalNamespaces - [namespace: string]: ConnectNamespace; 请求连接的可选信息， EVM系的key为\"eip155\"，如果对应的链信息钱包不支持，依然可以连接；如果需要连接自定义网络的话，可以将自定义网络的请求添加到此参数中，如果钱包中已经有该自定义网络，则会在请求结果 session 中返回该自定义链的信息；如果钱包不支持的话，请求结果session 中无该自定义链信息，可以再次调用 request 方法，method 设置为 wallet_addEthereumChain，添加该自定义链。\nchains: string[]; 链id信息,\nrpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；\n返回值\nPromise\n<SessionTypes.Struct | undefined>\ntopic: string; 会话标识；\nnamespaces:\nRecord<string, Namespace>\n; 成功连接的namespace 信息；\nchains: string[]; 连接的链信息；\naccounts: string[]; 连接的账户信息；\nmethods: string[]; 当前namespace下，钱包支持的方法；\ndefaultChain?: string; 当前会话的默认链\nsessionConfig?: SessionConfig\nDAppInfo: object DApp 信息；\nname:string\nicon:string\n示例\nvar\nsession\n=\nawait\nuniversalUi\n.\nopenModal\n(\n{\nnamespaces\n:\n{\neip155\n:\n{\n// 请按需组合需要的链id传入，多条链就传入多个\nchains\n:\n[\n\"eip155:1\"\n,\n\"eip155:137\"\n]\n,\ndefaultChain\n:\n\"1\"\n,\nrpcMap\n:\n{\n\"137\"\n:\n\"https://polygon.drpc.org\"\n}\n}\n}\n,\noptionalNamespaces\n:\n{\neip155\n:\n{\nchains\n:\n[\n\"eip155:43114\"\n]\n}\n}\n}\n)\n连接钱包并签名\n#\n连接钱包获取钱包地址，并对数据进行签名；签名结果会在\"connect_signResponse\"的event中回调；\nawait universalUi.openModalAndSign(connectParams: ConnectParams,signRequest: RequestParams[]);\n请求参数\nconnectParams - ConnectParams\nnamespaces - [namespace: string]: ConnectNamespace ; 请求连接的必要信息， EVM系的key为\"eip155\"\n，如果请求的链中，有任何一个链钱包不支持的话，钱包会拒绝连接；\nchains: string[]; 链id信息，EIP155中定义的十进制数字，比如以太坊是eip155:1,\ndefaultChain?: string; 默认链\nrpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；\noptionalNamespaces - [namespace: string]: ConnectNamespace; 请求连接的可选信息， EVM系的key为\"eip155\"，如果对应的链信息钱包不支持，依然可以连接；如果需要连接自定义网络的话，可以将自定义网络的请求添加到此参数中，如果钱包中已经有该自定义网络，则会在请求结果 session 中返回该自定义链的信息；如果钱包不支持的话，请求结果session 中无该自定义链信息，可以再次调用 request 方法，method 设置为 wallet_addEthereumChain，添加该自定义链。\nchains: string[]; 链id信息,\nrpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；\nsignRequest - RequestParams[]; 请求连接并签名的方法, 同时最多只能支持一个方法；\nmethod: string; 请求的方法名称,EVM系支持的方法有：\"personal_sign\"；\nchainId: string; 执行方法所在的链的ID, 该chainId必须包含在上面的namespaces中；\nparams: unknown[] | Record\n<string, unknown>\n| object | undefined; 请求的方法对应的参数；\n返回值\nPromise\n<SessionTypes.Struct | undefined>\ntopic: string; 会话标识；\nnamespaces:\nRecord<string, Namespace>\n; 成功连接的namespace 信息；\nchains: string[]; 连接的链信息；\naccounts: string[]; 连接的账户信息；\nmethods: string[]; 当前namespace下，钱包支持的方法；\ndefaultChain?: string; 当前会话的默认链\nsessionConfig?: SessionConfig\nDAppInfo: object DApp 信息；\nname:string\nicon:string\n示例\n// 先添加签名结果监听\nuniversalUi\n.\non\n(\n\"connect_signResponse\"\n,\n(\nsignResponse\n)\n=>\n{\nconsole\n.\nlog\n(\nsignResponse\n)\n;\n}\n)\n;\nvar\nsession\n=\nawait\nuniversalUi\n.\nopenModalAndSign\n(\n{\nnamespaces\n:\n{\neip155\n:\n{\n// 请按需组合需要的链id传入，多条链就传入多个\nchains\n:\n[\n\"eip155:1\"\n,\n\"eip155:137\"\n]\n,\ndefaultChain\n:\n\"1\"\n,\nrpcMap\n:\n{\n\"137\"\n:\n\"https://polygon.drpc.org\"\n}\n}\n}\n,\noptionalNamespaces\n:\n{\neip155\n:\n{\nchains\n:\n[\n\"eip155:43114\"\n]\n}\n}\n,\nsessionConfig\n:\n{\nredirect\n:\n\"tg://resolve\"\n}\n}\n,\n[\n{\nmethod\n:\n\"personal_sign\"\n,\nchainId\n:\n\"eip155:1\"\n,\nparams\n:\n[\n\"0x4d7920656d61696c206973206a6f686e40646f652e636f6d202d2031373237353937343537313336\"\n,\n]\n,\n}\n]\n)\n判断钱包是否已连接\n#\n获取当前是否有连接钱包;\n返回值\nboolean\n示例\nuniversalUi\n.\nconnected\n(\n)\n;\n准备交易\n#\n向钱包发送消息的方法，支持签名，交易;\nuniversalUi.request(requestArguments, chain, actionConfigurationRequest);\n请求参数\nrequestArguments - object\nmethod: string; 请求的方法名，\nparams?: unknown[] | Record\n<string, unknown>\n| object | undefined; 请求的方法对应的参数；\nchain: string; 请求方法执行的链，建议传该参数，如果未传的话，会被设置为当前的defaultChain；\nactionConfigurationRequest - object\nmodals : ('before' | 'success' | 'error')[] | 'all' 交易过程中的提醒界面展示模式，如果request 没有设置该参数的，取init 时候添加的参数，如果init 没有也设置该参数，则取默认值：'before',\ntmaReturnUrl -string 'back' | 'none' |\n${string}://${string}\n; Telegram Mini Wallet 钱包中，用户签署/拒绝请求时深层链接的返回策略，一般配置back,表示签名后关闭钱包，会自动展示出DApp；none 表示签名后不做处理；默认为back；\nreturnStrategy -string 'none' |\n${string}://${string}\n; App 钱包中，用户签署或拒绝请求时深层链接的返回策略，如果是Telegram中的Mini App，可以配置tg://resolve，如果这里没有配置的话，会取init方法传递的 returnStrategy，默认为 ‘none’\n返回值\n返回参数详情同EVM兼容链的发送签名和交易\n示例\n示例同EVM兼容链的发送签名和交易\nlet\nchain\n=\n'eip155:1'\nvar\ndata\n=\n{\n}\ndata\n=\n{\n\"method\"\n:\n\"personal_sign\"\n,\n\"params\"\n:\n[\n\"0x506c65617365207369676e2074686973206d65737361676520746f20636f6e6669726d20796f7572206964656e746974792e\"\n,\n\"0x4B0897b0513FdBeEc7C469D9aF4fA6C0752aBea7\"\n]\n}\nvar\npersonalSignResult\n=\nawait\nuniversalUi\n.\nrequest\n(\ndata\n,\nchain\n,\n'all'\n)\n//personalSignResult: 0xe8d34297c33a61\"\n使用RPC\n#\n当EVM系的 request 中 method 无法满足需求时，可通过配置 RPC 实现更多功能，在连接钱包openModal或者openModalAndSign时,RPC配置在rpcMap中。\n示例\n//查询交易Hash的详细信息\nlet\nrpcData\n=\n{\nmethod\n:\n\"eth_getTransactionByHash\"\n,\nparams\n:\n[\n\"0xd62fa4ea3cf7ee3bf6f5302b764490730186ed6a567c283517e8cb3c36142e1a\"\n]\n,\n}\n;\nlet\nresult\n=\nawait\nuniversalUi\n.\nrequest\n(\nrpcData\n,\n\"eip155:137\"\n)\n关闭连接弹窗\n#\n示例\nuniversalUi\n.\ncloseModal\n(\n)\n;\n监听连接弹窗状态变化\n#\n示例\nconst\nunsubscribe\n=\nuniversalUi\n.\nonModalStateChange\n(\n(\nstate\n)\n=>\n{\n}\n)\n不需要监听的时候移除监听\nunsubscribe\n(\n)\n获取当前连接的会话信息\n#\n获取当前是否有连接钱包，以及已连接的钱包的相关信息；\n示例\nuniversalUi\n.\nsession\n;\n设置ui配置项\n#\n支持修改主题，文字语言设置，也可以在初始化的时候添加这些配置；\n示例\nuniversalUi\n.\nuiOptions\n=\n{\nlanguage\n:\n'zh_CN'\n,\nuiPreferences\n:\n{\ntheme\n:\nTHEME\n.\nDARK\n}\n}\n;\n设置默认网络\n#\n在连接多个网络的状况下,如果开发者没有明确指定当前操作所在网络,则通过默认网络进行交互。\n'setDefaultChain(chain)'\n示例\nuniversalUi\n.\nsetDefaultChain\n(\n\"eip155:1\"\n)\n断开钱包连接\n#\n示例\nuniversalUi\n.\ndisconnect\n(\n)\n;\nEvent事件\n#\n// 生成 universalLink\nuniversalUi\n.\non\n(\n\"display_uri\"\n,\n(\nuri\n)\n=>\n{\nconsole\n.\nlog\n(\nuri\n)\n;\n}\n)\n;\n// session 信息变更（例如添加自定义链）会触发该事件；\nuniversalUi\n.\non\n(\n\"session_update\"\n,\n(\nsession\n)\n=>\n{\nconsole\n.\nlog\n(\nJSON\n.\nstringify\n(\nsession\n)\n)\n;\n}\n)\n;\n// 断开连接会触发该事件；\nuniversalUi\n.\non\n(\n\"session_delete\"\n,\n(\n{\ntopic\n}\n)\n=>\n{\nconsole\n.\nlog\n(\ntopic\n)\n;\n}\n)\n;\n// 连接并签名时,签名结果会触发该事件;\nuniversalUi\n.\non\n(\n\"connect_signResponse\"\n,\n(\nsignResponse\n)\n=>\n{\nconsole\n.\nlog\n(\nsignResponse\n)\n;\n}\n)\n;\n// 连接OKX插件钱包后，切换插件钱包，会触发该事件；\nuniversalUi\n.\non\n(\n\"accountChanged\"\n,\n(\nsession\n)\n=>\n{\nif\n(\nsession\n)\n{\nconsole\n.\nlog\n(\n`\naccountChanged\n`\n,\nJSON\n.\nstringify\n(\nsession\n)\n)\n;\n}\n}\n)\n;\n错误码\n#\n在连接，交易，断开连接的过程中可能抛出的异常\n异常\n错误码\n描述\nOKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR\n未知异常\nOKX_CONNECT_ERROR_CODES.ALREADY_CONNECTED_ERROR\n钱包已连接\nOKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR\n钱包未连接\nOKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR\n用户拒绝\nOKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED\n方法不支持\nOKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED\n链不支持\nOKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED\n钱包不支持\nOKX_CONNECT_ERROR_CODES.CONNECTION_ERROR\n连接异常\nexport\nenum\nOKX_CONNECT_ERROR_CODES\n{\nUNKNOWN_ERROR\n=\n0\n,\nALREADY_CONNECTED_ERROR\n=\n11\n,\nNOT_CONNECTED_ERROR\n=\n12\n,\nUSER_REJECTS_ERROR\n=\n300\n,\nMETHOD_NOT_SUPPORTED\n=\n400\n,\nCHAIN_NOT_SUPPORTED\n=\n500\n,\nWALLET_NOT_SUPPORTED\n=\n600\n,\nCONNECTION_ERROR\n=\n700\n}",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"ui\">UI<a class=\"index_header-anchor__Xqb+L\" href=\"#ui\" style=\"opacity:0\">#</a></h1>\n<p>在 SDK 的基础上，我们也提供了 UI 界面。如果选择通过UI接入，若DApp运行在 Telegram内，则用户可以选择唤起欧易 App 钱包或者停留在Telegram并唤起欧易 Telegram Mini 钱包。</p>\n<h2 data-content=\"通过npm安装\" id=\"通过npm安装\">通过npm安装<a class=\"index_header-anchor__Xqb+L\" href=\"#通过npm安装\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">npm install @okxconnect/ui</code></pre></div>\n<h2 data-content=\"初始化\" id=\"初始化\">初始化<a class=\"index_header-anchor__Xqb+L\" href=\"#初始化\" style=\"opacity:0\">#</a></h2>\n<p>连接钱包之前，需要先创建一个对象，用于后续连接钱包、发送交易等操作。</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">OKXUniversalConnectUI.init(DAppMetaData, actionsConfiguration, uiPreferences, language, restoreConnection)</code></pre></div>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>DAppMetaData - object<!-- -->\n<ul>\n<li>name - string: 应用名称，不会作为唯一表示</li>\n<li>icon - string: 应用图标的 URL。必须是 PNG、ICO 等格式，不支持 SVG 图标。最好传递指向 180x180px PNG 图标的 url。</li>\n</ul>\n</li>\n<li>actionsConfiguration - object<!-- -->\n<ul>\n<li>modals - ('before' | 'success' | 'error')[] | 'all'  交易过程中的提醒界面展示模式，默认为'before'</li>\n<li>returnStrategy -string 'none' | <code>${string}://${string}</code>; 针对app 钱包，指定当用户签署/拒绝请求时深层链接的返回策略，如果是在telegram中，可以配置tg://resolve；</li>\n<li>tmaReturnUrl -string 'back' | 'none' | <code>${string}://${string}</code>; Telegram Mini Wallet 钱包中，用户签署/拒绝请求时深层链接的返回策略，一般配置back,表示签名后关闭钱包，会自动展示出DApp；none 表示签名后不做处理；默认为back；</li>\n</ul>\n</li>\n<li>uiPreferences -object<!-- -->\n<ul>\n<li>theme -  Theme 可以是：THEME.DARK, THEME.LIGHT, \"SYSTEM\"</li>\n</ul>\n</li>\n<li>language - \"en_US\" | \"ru_RU\" | \"zh_CN\" | \"ar_AE\" | \"cs_CZ\" | \"de_DE\" | \"es_ES\" | \"es_LAT\" | \"fr_FR\" | \"id_ID\" | \"it_IT\" | \"nl_NL\" | \"pl_PL\" | \"pt_BR\" | \"pt_PT\" | \"ro_RO\" | \"tr_TR\" | \"uk_UA\" | \"vi_VN\";\n, 默认为en_US</li>\n<li>restoreConnection?: boolean - 是否自动回复之前的连接；</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>OKXUniversalConnectUI</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> OKXUniversalConnectUI <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@okxconnect/ui\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> universalUi <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> OKXUniversalConnectUI<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  DAppMetaData<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    icon<span class=\"token operator\">:</span> <span class=\"token string\">\"https://static.okx.com/cdn/assets/imgs/247/58E63FEA47A2B7D7.png\"</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token operator\">:</span> <span class=\"token string\">\"OKX Connect Demo\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  actionsConfiguration<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    returnStrategy<span class=\"token operator\">:</span> <span class=\"token string\">'tg://resolve'</span><span class=\"token punctuation\">,</span>\n    modals<span class=\"token operator\">:</span><span class=\"token string\">'all'</span><span class=\"token punctuation\">,</span>\n    tmaReturnUrl<span class=\"token operator\">:</span><span class=\"token string\">'back'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  language<span class=\"token operator\">:</span> <span class=\"token string\">\"en_US\"</span><span class=\"token punctuation\">,</span>\n  uiPreferences<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    theme<span class=\"token operator\">:</span> <span class=\"token constant\">THEME</span><span class=\"token punctuation\">.</span><span class=\"token constant\">LIGHT</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 连接OKX插件钱包后，切换插件钱包，会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accountChanged\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">accountChanged </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre></div>\n<h2 data-content=\"连接钱包\" id=\"连接钱包\">连接钱包<a class=\"index_header-anchor__Xqb+L\" href=\"#连接钱包\" style=\"opacity:0\">#</a></h2>\n<p>连接钱包去获取钱包地址，作为标识符和用于签名交易的必要参数，</p>\n<p><code>await universalUi.openModal(connectParams: ConnectParams);</code></p>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>connectParams - ConnectParams<!-- -->\n<ul>\n<li>namespaces - [namespace: string]: ConnectNamespace ; 请求连接的必要信息， EVM系的key为\"eip155\"\n，如果请求的链中，有任何一个链钱包不支持的话，钱包会拒绝连接；<!-- -->\n<ul>\n<li>chains: string[]; 链id信息，EIP155中定义的十进制数字，比如以太坊是eip155:1,</li>\n<li>defaultChain?: string; 默认链</li>\n<li>rpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；</li>\n</ul>\n</li>\n<li>optionalNamespaces - [namespace: string]: ConnectNamespace; 请求连接的可选信息， EVM系的key为\"eip155\"，如果对应的链信息钱包不支持，依然可以连接；如果需要连接自定义网络的话，可以将自定义网络的请求添加到此参数中，如果钱包中已经有该自定义网络，则会在请求结果 session 中返回该自定义链的信息；如果钱包不支持的话，请求结果session 中无该自定义链信息，可以再次调用 request 方法，method 设置为 wallet_addEthereumChain，添加该自定义链。<!-- -->\n<ul>\n<li>chains: string[]; 链id信息,</li>\n<li>rpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>Promise<code>&lt;SessionTypes.Struct | undefined&gt;</code>\n<ul>\n<li>topic: string; 会话标识；</li>\n<li>namespaces: <code>Record&lt;string, Namespace&gt;</code>; 成功连接的namespace 信息；<!-- -->\n<ul>\n<li>chains: string[]; 连接的链信息；</li>\n<li>accounts: string[]; 连接的账户信息；</li>\n<li>methods: string[]; 当前namespace下，钱包支持的方法；</li>\n<li>defaultChain?: string; 当前会话的默认链</li>\n</ul>\n</li>\n<li>sessionConfig?: SessionConfig<!-- -->\n<ul>\n<li>DAppInfo: object DApp 信息；<!-- -->\n<ul>\n<li>name:string</li>\n<li>icon:string</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">var</span> session <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">openModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  namespaces<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    eip155<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 请按需组合需要的链id传入，多条链就传入多个</span>\n      chains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"eip155:1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"eip155:137\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      defaultChain<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n      rpcMap<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"137\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"https://polygon.drpc.org\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  optionalNamespaces<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    eip155<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      chains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"eip155:43114\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"连接钱包并签名\" id=\"连接钱包并签名\">连接钱包并签名<a class=\"index_header-anchor__Xqb+L\" href=\"#连接钱包并签名\" style=\"opacity:0\">#</a></h2>\n<p>连接钱包获取钱包地址，并对数据进行签名；签名结果会在\"connect_signResponse\"的event中回调；</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">await universalUi.openModalAndSign(connectParams: ConnectParams,signRequest: RequestParams[]);</code></pre></div>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>connectParams - ConnectParams<!-- -->\n<ul>\n<li>namespaces - [namespace: string]: ConnectNamespace ; 请求连接的必要信息， EVM系的key为\"eip155\"\n，如果请求的链中，有任何一个链钱包不支持的话，钱包会拒绝连接；<!-- -->\n<ul>\n<li>chains: string[]; 链id信息，EIP155中定义的十进制数字，比如以太坊是eip155:1,</li>\n<li>defaultChain?: string; 默认链</li>\n<li>rpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；</li>\n</ul>\n</li>\n<li>optionalNamespaces - [namespace: string]: ConnectNamespace; 请求连接的可选信息， EVM系的key为\"eip155\"，如果对应的链信息钱包不支持，依然可以连接；如果需要连接自定义网络的话，可以将自定义网络的请求添加到此参数中，如果钱包中已经有该自定义网络，则会在请求结果 session 中返回该自定义链的信息；如果钱包不支持的话，请求结果session 中无该自定义链信息，可以再次调用 request 方法，method 设置为 wallet_addEthereumChain，添加该自定义链。<!-- -->\n<ul>\n<li>chains: string[]; 链id信息,</li>\n<li>rpcMap?: [chainId: string]: string; rpc 信息，配置了rpc url才能请求链上rpc信息，仅支持EVM系，配置RPC的链必须包含在chains中；</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>signRequest - RequestParams[]; 请求连接并签名的方法, 同时最多只能支持一个方法；<!-- -->\n<ul>\n<li>method: string;  请求的方法名称,EVM系支持的方法有：\"personal_sign\"；</li>\n<li>chainId: string; 执行方法所在的链的ID, 该chainId必须包含在上面的namespaces中；</li>\n<li>params: unknown[] | Record<code>&lt;string, unknown&gt;</code> | object | undefined; 请求的方法对应的参数；</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<ul>\n<li>Promise<code>&lt;SessionTypes.Struct | undefined&gt;</code>\n<ul>\n<li>topic: string; 会话标识；</li>\n<li>namespaces: <code>Record&lt;string, Namespace&gt;</code>; 成功连接的namespace 信息；<!-- -->\n<ul>\n<li>chains: string[]; 连接的链信息；</li>\n<li>accounts: string[]; 连接的账户信息；</li>\n<li>methods: string[]; 当前namespace下，钱包支持的方法；</li>\n<li>defaultChain?: string; 当前会话的默认链</li>\n</ul>\n</li>\n<li>sessionConfig?: SessionConfig<!-- -->\n<ul>\n<li>DAppInfo: object DApp 信息；<!-- -->\n<ul>\n<li>name:string</li>\n<li>icon:string\n<strong>示例</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 先添加签名结果监听</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connect_signResponse\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> session <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">openModalAndSign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  namespaces<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    eip155<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// 请按需组合需要的链id传入，多条链就传入多个</span>\n      chains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"eip155:1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"eip155:137\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      defaultChain<span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n      rpcMap<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string-property property\">\"137\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"https://polygon.drpc.org\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  optionalNamespaces<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    eip155<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      chains<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"eip155:43114\"</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  sessionConfig<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    redirect<span class=\"token operator\">:</span> <span class=\"token string\">\"tg://resolve\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n  method<span class=\"token operator\">:</span> <span class=\"token string\">\"personal_sign\"</span><span class=\"token punctuation\">,</span>\n  chainId<span class=\"token operator\">:</span> <span class=\"token string\">\"eip155:1\"</span><span class=\"token punctuation\">,</span>\n  params<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"0x4d7920656d61696c206973206a6f686e40646f652e636f6d202d2031373237353937343537313336\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"判断钱包是否已连接\" id=\"判断钱包是否已连接\">判断钱包是否已连接<a class=\"index_header-anchor__Xqb+L\" href=\"#判断钱包是否已连接\" style=\"opacity:0\">#</a></h2>\n<p>获取当前是否有连接钱包;</p>\n<p><strong>返回值</strong></p>\n<ul>\n<li>boolean</li>\n</ul>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">connected</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"准备交易\" id=\"准备交易\">准备交易<a class=\"index_header-anchor__Xqb+L\" href=\"#准备交易\" style=\"opacity:0\">#</a></h2>\n<p>向钱包发送消息的方法，支持签名，交易;</p>\n<div class=\"remark-highlight\"><pre class=\"language-unknown\"><code class=\"language-unknown\">universalUi.request(requestArguments, chain, actionConfigurationRequest);</code></pre></div>\n<p><strong>请求参数</strong></p>\n<ul>\n<li>requestArguments - object<!-- -->\n<ul>\n<li>method: string; 请求的方法名，</li>\n<li>params?: unknown[]  | Record<code>&lt;string, unknown&gt;</code> | object | undefined; 请求的方法对应的参数；</li>\n</ul>\n</li>\n<li>chain: string; 请求方法执行的链，建议传该参数，如果未传的话，会被设置为当前的defaultChain；</li>\n<li>actionConfigurationRequest - object<!-- -->\n<ul>\n<li>modals : ('before' | 'success' | 'error')[] | 'all' 交易过程中的提醒界面展示模式，如果request 没有设置该参数的，取init 时候添加的参数，如果init 没有也设置该参数，则取默认值：'before',</li>\n<li>tmaReturnUrl -string 'back' | 'none' | <code>${string}://${string}</code>; Telegram Mini Wallet 钱包中，用户签署/拒绝请求时深层链接的返回策略，一般配置back,表示签名后关闭钱包，会自动展示出DApp；none 表示签名后不做处理；默认为back；</li>\n<li>returnStrategy -string 'none' | <code>${string}://${string}</code>; App 钱包中，用户签署或拒绝请求时深层链接的返回策略，如果是Telegram中的Mini App，可以配置tg://resolve，如果这里没有配置的话，会取init方法传递的 returnStrategy，默认为 ‘none’</li>\n</ul>\n</li>\n</ul>\n<p><strong>返回值</strong></p>\n<p><a href=\"/zh-hans/build/docs/sdks/app-connect-evm-sdk#%E5%8F%91%E9%80%81%E7%AD%BE%E5%90%8D%E5%92%8C%E4%BA%A4%E6%98%93\">返回参数详情同EVM兼容链的发送签名和交易</a></p>\n<p><strong>示例</strong></p>\n<p><a href=\"/zh-hans/build/docs/sdks/app-connect-evm-sdk#%E5%8F%91%E9%80%81%E7%AD%BE%E5%90%8D%E5%92%8C%E4%BA%A4%E6%98%93\">示例同EVM兼容链的发送签名和交易</a></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">let</span> chain <span class=\"token operator\">=</span> <span class=\"token string\">'eip155:1'</span>\n<span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string-property property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"personal_sign\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string-property property\">\"params\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"0x506c65617365207369676e2074686973206d65737361676520746f20636f6e6669726d20796f7572206964656e746974792e\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"0x4B0897b0513FdBeEc7C469D9aF4fA6C0752aBea7\"</span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> personalSignResult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> chain<span class=\"token punctuation\">,</span><span class=\"token string\">'all'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">//personalSignResult:   0xe8d34297c33a61\"</span>\n\n</code></pre></div>\n<h2 data-content=\"使用RPC\" id=\"使用rpc\">使用RPC<a class=\"index_header-anchor__Xqb+L\" href=\"#使用rpc\" style=\"opacity:0\">#</a></h2>\n<p>当EVM系的 request 中 method 无法满足需求时，可通过配置 RPC 实现更多功能，在连接钱包openModal或者openModalAndSign时,RPC配置在rpcMap中。</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">//查询交易Hash的详细信息</span>\n<span class=\"token keyword\">let</span> rpcData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  method<span class=\"token operator\">:</span> <span class=\"token string\">\"eth_getTransactionByHash\"</span><span class=\"token punctuation\">,</span>\n  params<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"0xd62fa4ea3cf7ee3bf6f5302b764490730186ed6a567c283517e8cb3c36142e1a\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span>rpcData<span class=\"token punctuation\">,</span><span class=\"token string\">\"eip155:137\"</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"关闭连接弹窗\" id=\"关闭连接弹窗\">关闭连接弹窗<a class=\"index_header-anchor__Xqb+L\" href=\"#关闭连接弹窗\" style=\"opacity:0\">#</a></h2>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">closeModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"监听连接弹窗状态变化\" id=\"监听连接弹窗状态变化\">监听连接弹窗状态变化<a class=\"index_header-anchor__Xqb+L\" href=\"#监听连接弹窗状态变化\" style=\"opacity:0\">#</a></h2>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> unsubscribe <span class=\"token operator\">=</span> universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">onModalStateChange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token operator\">=&gt;</span><span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>不需要监听的时候移除监听</p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"获取当前连接的会话信息\" id=\"获取当前连接的会话信息\">获取当前连接的会话信息<a class=\"index_header-anchor__Xqb+L\" href=\"#获取当前连接的会话信息\" style=\"opacity:0\">#</a></h2>\n<p>获取当前是否有连接钱包，以及已连接的钱包的相关信息；</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"设置ui配置项\" id=\"设置ui配置项\">设置ui配置项<a class=\"index_header-anchor__Xqb+L\" href=\"#设置ui配置项\" style=\"opacity:0\">#</a></h2>\n<p>支持修改主题，文字语言设置，也可以在初始化的时候添加这些配置；</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span>uiOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  language<span class=\"token operator\">:</span> <span class=\"token string\">'zh_CN'</span><span class=\"token punctuation\">,</span>\n  uiPreferences<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    theme<span class=\"token operator\">:</span> <span class=\"token constant\">THEME</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DARK</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"设置默认网络\" id=\"设置默认网络\">设置默认网络<a class=\"index_header-anchor__Xqb+L\" href=\"#设置默认网络\" style=\"opacity:0\">#</a></h2>\n<p>在连接多个网络的状况下,如果开发者没有明确指定当前操作所在网络,则通过默认网络进行交互。</p>\n<p>'setDefaultChain(chain)'</p>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">setDefaultChain</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"eip155:1\"</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<h2 data-content=\"断开钱包连接\" id=\"断开钱包连接\">断开钱包连接<a class=\"index_header-anchor__Xqb+L\" href=\"#断开钱包连接\" style=\"opacity:0\">#</a></h2>\n<p><strong>示例</strong></p>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\">universalUi<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre></div>\n<h2 data-content=\"Event事件\" id=\"event事件\">Event事件<a class=\"index_header-anchor__Xqb+L\" href=\"#event事件\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// 生成 universalLink</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"display_uri\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>uri<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>uri<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// session 信息变更（例如添加自定义链）会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"session_update\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 断开连接会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"session_delete\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>topic<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 连接并签名时,签名结果会触发该事件;</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"connect_signResponse\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>signResponse<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 连接OKX插件钱包后，切换插件钱包，会触发该事件；</span>\nuniversalUi<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"accountChanged\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">accountChanged </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre></div>\n<h2 data-content=\"错误码\" id=\"错误码\">错误码<a class=\"index_header-anchor__Xqb+L\" href=\"#错误码\" style=\"opacity:0\">#</a></h2>\n<p>在连接，交易，断开连接的过程中可能抛出的异常</p>\n<p><strong>异常</strong></p>\n<div class=\"index_table__kvZz5\"><table><thead><tr><th>错误码</th><th>描述</th></tr></thead><tbody><tr><td>OKX_CONNECT_ERROR_CODES.UNKNOWN_ERROR</td><td>未知异常</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.ALREADY_CONNECTED_ERROR</td><td>钱包已连接</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.NOT_CONNECTED_ERROR</td><td>钱包未连接</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.USER_REJECTS_ERROR</td><td>用户拒绝</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.METHOD_NOT_SUPPORTED</td><td>方法不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.CHAIN_NOT_SUPPORTED</td><td>链不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.WALLET_NOT_SUPPORTED</td><td>钱包不支持</td></tr><tr><td>OKX_CONNECT_ERROR_CODES.CONNECTION_ERROR</td><td>连接异常</td></tr></tbody></table></div>\n<div class=\"remark-highlight\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">enum</span> <span class=\"token constant\">OKX_CONNECT_ERROR_CODES</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">UNKNOWN_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">ALREADY_CONNECTED_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">NOT_CONNECTED_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">USER_REJECTS_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">METHOD_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">CHAIN_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">WALLET_NOT_SUPPORTED</span> <span class=\"token operator\">=</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">CONNECTION_ERROR</span> <span class=\"token operator\">=</span> <span class=\"token number\">700</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/sdks/app-connect-evm-ui#获取当前连接的会话信息",
  "navigation": {
    "breadcrumbs": [
      "DApp 连接钱包",
      "EVM兼容链",
      "UI"
    ],
    "sidebar_links": [
      "什么是连接钱包",
      "支持的网络",
      "接入前提",
      "EVM 兼容链",
      "SDK",
      "UI",
      "Bitcoin 兼容链",
      "Solana 兼容链",
      "TON",
      "SUI",
      "Aptos/Movement",
      "Cosmos 系/Sei",
      "Tron",
      "Starknet",
      "常见问题",
      "接入前提",
      "EVM 兼容链",
      "Bitcoin 兼容链",
      "Tron",
      "Solana 兼容链"
    ],
    "toc": [
      "通过npm安装",
      "初始化",
      "连接钱包",
      "连接钱包并签名",
      "判断钱包是否已连接",
      "准备交易",
      "使用RPC",
      "关闭连接弹窗",
      "监听连接弹窗状态变化",
      "获取当前连接的会话信息",
      "设置ui配置项",
      "设置默认网络",
      "断开钱包连接",
      "Event事件",
      "错误码"
    ]
  },
  "word_count": 1046,
  "extract_time": "2025-05-27 07:13:59"
}