{
  "title": "EVM 示例 | DEX SDK  | 资源 | DEX API | DEX API 文档 | 欧易",
  "text": "EVM 示例\n#\n执行授权指令\n#\n// approval.ts\nimport\n{\nclient\n}\nfrom\n'./DexClient'\n;\n// Helper function to convert human-readable amounts to base units\nexport\nfunction\ntoBaseUnits\n(\namount\n:\nstring\n,\ndecimals\n:\nnumber\n)\n:\nstring\n{\n// Remove any decimal point and count the decimal places\nconst\n[\nintegerPart\n,\ndecimalPart\n=\n''\n]\n=\namount\n.\nsplit\n(\n'.'\n)\n;\nconst\ncurrentDecimals\n=\ndecimalPart\n.\nlength\n;\n// Combine integer and decimal parts, removing the decimal point\nlet\nresult\n=\nintegerPart\n+\ndecimalPart\n;\n// Add zeros if we need more decimal places\nif\n(\ncurrentDecimals\n<\ndecimals\n)\n{\nresult\n=\nresult\n+\n'0'\n.\nrepeat\n(\ndecimals\n-\ncurrentDecimals\n)\n;\n}\n// Remove digits if we have too many decimal places\nelse\nif\n(\ncurrentDecimals\n>\ndecimals\n)\n{\nresult\n=\nresult\n.\nslice\n(\n0\n,\nresult\n.\nlength\n-\n(\ncurrentDecimals\n-\ndecimals\n)\n)\n;\n}\n// Remove leading zeros\nresult\n=\nresult\n.\nreplace\n(\n/\n^\n0\n+\n/\n,\n''\n)\n||\n'0'\n;\nreturn\nresult\n;\n}\n/**\n* Example: Approve a token for swapping\n*/\nasync\nfunction\nexecuteApproval\n(\ntokenAddress\n:\nstring\n,\namount\n:\nstring\n)\n{\ntry\n{\n// Get token information using quote\nconsole\n.\nlog\n(\n\"Getting token information...\"\n)\n;\nconst\ntokenInfo\n=\nawait\nclient\n.\ndex\n.\ngetQuote\n(\n{\nchainId\n:\n'8453'\n,\n// Base Chain\nfromTokenAddress\n:\ntokenAddress\n,\ntoTokenAddress\n:\n'0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE'\n,\n// Native token\namount\n:\n'1000000'\n,\n// Use a reasonable amount for quote\nslippage\n:\n'0.5'\n}\n)\n;\nconst\ntokenDecimals\n=\nparseInt\n(\ntokenInfo\n.\ndata\n[\n0\n]\n.\nfromToken\n.\ndecimal\n)\n;\nconst\nrawAmount\n=\ntoBaseUnits\n(\namount\n,\ntokenDecimals\n)\n;\nconsole\n.\nlog\n(\n`\n\\nApproval Details:\n`\n)\n;\nconsole\n.\nlog\n(\n`\n--------------------\n`\n)\n;\nconsole\n.\nlog\n(\n`\nToken:\n${\ntokenInfo\n.\ndata\n[\n0\n]\n.\nfromToken\n.\ntokenSymbol\n}\n`\n)\n;\nconsole\n.\nlog\n(\n`\nAmount:\n${\namount\n}\n${\ntokenInfo\n.\ndata\n[\n0\n]\n.\nfromToken\n.\ntokenSymbol\n}\n`\n)\n;\nconsole\n.\nlog\n(\n`\nAmount in base units:\n${\nrawAmount\n}\n`\n)\n;\n// Execute the approval\nconsole\n.\nlog\n(\n\"\\nExecuting approval...\"\n)\n;\nconst\nresult\n=\nawait\nclient\n.\ndex\n.\nexecuteApproval\n(\n{\nchainId\n:\n'8453'\n,\n// Base Chain\ntokenContractAddress\n:\ntokenAddress\n,\napproveAmount\n:\nrawAmount\n}\n)\n;\nif\n(\n'alreadyApproved'\nin\nresult\n)\n{\nconsole\n.\nlog\n(\n\"\\nToken already approved for the requested amount!\"\n)\n;\nreturn\n{\nsuccess\n:\ntrue\n,\nalreadyApproved\n:\ntrue\n}\n;\n}\nelse\n{\nconsole\n.\nlog\n(\n\"\\nApproval completed successfully!\"\n)\n;\nconsole\n.\nlog\n(\n\"Transaction Hash:\"\n,\nresult\n.\ntransactionHash\n)\n;\nconsole\n.\nlog\n(\n\"Explorer URL:\"\n,\nresult\n.\nexplorerUrl\n)\n;\nreturn\nresult\n;\n}\n}\ncatch\n(\nerror\n)\n{\nif\n(\nerror\ninstanceof\nError\n)\n{\nconsole\n.\nerror\n(\n'Error executing approval:'\n,\nerror\n.\nmessage\n)\n;\n}\nthrow\nerror\n;\n}\n}\n// Run if this file is executed directly\nif\n(\nrequire\n.\nmain\n===\nmodule\n)\n{\n// Example usage: ts-node approval.ts 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913 1000\nconst\nargs\n=\nprocess\n.\nargv\n.\nslice\n(\n2\n)\n;\nif\n(\nargs\n.\nlength\n!==\n2\n)\n{\nconsole\n.\nlog\n(\n\"Usage: ts-node approval.ts <tokenAddress> <amountToApprove>\"\n)\n;\nconsole\n.\nlog\n(\n\"\\nExamples:\"\n)\n;\nconsole\n.\nlog\n(\n\" # Approve 1000 USDC\"\n)\n;\nconsole\n.\nlog\n(\n`\nts-node approval.ts 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913 1000\n`\n)\n;\nprocess\n.\nexit\n(\n1\n)\n;\n}\nconst\n[\ntokenAddress\n,\namount\n]\n=\nargs\n;\nexecuteApproval\n(\ntokenAddress\n,\namount\n)\n.\nthen\n(\n(\n)\n=>\nprocess\n.\nexit\n(\n0\n)\n)\n.\ncatch\n(\n(\nerror\n)\n=>\n{\nconsole\n.\nerror\n(\n'Error:'\n,\nerror\n)\n;\nprocess\n.\nexit\n(\n1\n)\n;\n}\n)\n;\n}\nexport\n{\nexecuteApproval\n}\n;\n创建兑换指令\n#\n// swap.ts\nimport\n{\nclient\n}\nfrom\n'./DexClient'\n;\n/**\n* Example: Execute a swap from ETH to USDC on Base chain\n*/\nasync\nfunction\nexecuteSwap\n(\n)\n{\ntry\n{\nif\n(\n!\nprocess\n.\nenv\n.\nEVM_PRIVATE_KEY\n)\n{\nthrow\nnew\nError\n(\n'Missing EVM_PRIVATE_KEY in .env file'\n)\n;\n}\n// You can change this to any EVM chain\n// For example, for Base, use chainId: '8453'\n// For example, for baseSepolia, use chainId: '84532'\n// You can also use SUI, use chainId: '784'\n// When using another Chain, you need to change the fromTokenAddress and toTokenAddress to the correct addresses for that chain\nconst\nswapResult\n=\nawait\nclient\n.\ndex\n.\nexecuteSwap\n(\n{\nchainId\n:\n'8453'\n,\n// Base chain ID\nfromTokenAddress\n:\n'0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE'\n,\n// Native ETH\ntoTokenAddress\n:\n'0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913'\n,\n// USDC on Base\namount\n:\nString\n(\n10\n*\n10\n**\n14\n)\n,\n// .0001 ETH\nslippage\n:\n'0.5'\n,\n// 0.5% slippage\nuserWalletAddress\n:\nprocess\n.\nenv\n.\nEVM_WALLET_ADDRESS\n!\n}\n)\n;\nconsole\n.\nlog\n(\n'Swap executed successfully:'\n)\n;\nconsole\n.\nlog\n(\nJSON\n.\nstringify\n(\nswapResult\n,\nnull\n,\n2\n)\n)\n;\nreturn\nswapResult\n;\n}\ncatch\n(\nerror\n)\n{\nif\n(\nerror\ninstanceof\nError\n)\n{\nconsole\n.\nerror\n(\n'Error executing swap:'\n,\nerror\n.\nmessage\n)\n;\n// API errors include details in the message\nif\n(\nerror\n.\nmessage\n.\nincludes\n(\n'API Error:'\n)\n)\n{\nconst\nmatch\n=\nerror\n.\nmessage\n.\nmatch\n(\n/\nAPI Error:\n(\n.\n*\n)\n/\n)\n;\nif\n(\nmatch\n)\nconsole\n.\nerror\n(\n'API Error Details:'\n,\nmatch\n[\n1\n]\n)\n;\n}\n}\nthrow\nerror\n;\n}\n}\n// Run if this file is executed directly\nif\n(\nrequire\n.\nmain\n===\nmodule\n)\n{\nexecuteSwap\n(\n)\n.\nthen\n(\n(\n)\n=>\nprocess\n.\nexit\n(\n0\n)\n)\n.\ncatch\n(\n(\nerror\n)\n=>\n{\nconsole\n.\nerror\n(\n'Error:'\n,\nerror\n)\n;\nprocess\n.\nexit\n(\n1\n)\n;\n}\n)\n;\n}\nexport\n{\nexecuteSwap\n}\n;\n获取报价\n#\nconst\nquote\n=\nawait\nclient\n.\ndex\n.\ngetQuote\n(\n{\nchainId\n:\n'8453'\n,\n// Base Chain\nfromTokenAddress\n:\n'0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913'\n,\n// USDC\ntoTokenAddress\n:\n'0x4200000000000000000000000000000000000006'\n,\n// WETH\namount\n:\n'1000000'\n,\n// 1 USDC (in smallest units)\nslippage\n:\n'0.5'\n// 0.5%\n}\n)\n;",
  "html": "<div class=\"routes_md__xWlGF\"><!--$--><h1 id=\"evm-示例\">EVM 示例<a class=\"index_header-anchor__Xqb+L\" href=\"#evm-示例\" style=\"opacity:0\">#</a></h1>\n<h2 data-content=\"执行授权指令\" id=\"执行授权指令\">执行授权指令<a class=\"index_header-anchor__Xqb+L\" href=\"#执行授权指令\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// approval.ts</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'./DexClient'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Helper function to convert human-readable amounts to base units</span>\n<span class=\"token keyword module\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">toBaseUnits</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">decimals</span><span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> string <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Remove any decimal point and count the decimal places</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>integerPart<span class=\"token punctuation\">,</span> decimalPart <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> amount<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> currentDecimals <span class=\"token operator\">=</span> decimalPart<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Combine integer and decimal parts, removing the decimal point</span>\n    <span class=\"token keyword\">let</span> result <span class=\"token operator\">=</span> integerPart <span class=\"token operator\">+</span> decimalPart<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Add zeros if we need more decimal places</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>currentDecimals <span class=\"token operator\">&lt;</span> decimals<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        result <span class=\"token operator\">=</span> result <span class=\"token operator\">+</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">repeat</span><span class=\"token punctuation\">(</span>decimals <span class=\"token operator\">-</span> currentDecimals<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// Remove digits if we have too many decimal places</span>\n    <span class=\"token keyword control-flow\">else</span> <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>currentDecimals <span class=\"token operator\">&gt;</span> decimals<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        result <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>currentDecimals <span class=\"token operator\">-</span> decimals<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// Remove leading zeros</span>\n    result <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\"><span class=\"token anchor function\">^</span>0<span class=\"token quantifier number\">+</span></span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword control-flow\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\"> * Example: Approve a token for swapping</span>\n<span class=\"token doc-comment comment\"> */</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">executeApproval</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">tokenAddress</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Get token information using quote</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Getting token information...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> tokenInfo <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token property-access\">dex</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getQuote</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">chainId</span><span class=\"token operator\">:</span> <span class=\"token string\">'8453'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Base Chain</span>\n            <span class=\"token literal-property property\">fromTokenAddress</span><span class=\"token operator\">:</span> tokenAddress<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">toTokenAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">'0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Native token</span>\n            <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token string\">'1000000'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Use a reasonable amount for quote</span>\n            <span class=\"token literal-property property\">slippage</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.5'</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> tokenDecimals <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>tokenInfo<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fromToken</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">decimal</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> rawAmount <span class=\"token operator\">=</span> <span class=\"token function\">toBaseUnits</span><span class=\"token punctuation\">(</span>amount<span class=\"token punctuation\">,</span> tokenDecimals<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\\nApproval Details:</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">--------------------</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Token: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tokenInfo<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fromToken</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">tokenSymbol</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Amount: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>amount<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tokenInfo<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fromToken</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">tokenSymbol</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Amount in base units: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>rawAmount<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Execute the approval</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nExecuting approval...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token property-access\">dex</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">executeApproval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">chainId</span><span class=\"token operator\">:</span> <span class=\"token string\">'8453'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Base Chain</span>\n            <span class=\"token literal-property property\">tokenContractAddress</span><span class=\"token operator\">:</span> tokenAddress<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">approveAmount</span><span class=\"token operator\">:</span> rawAmount\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'alreadyApproved'</span> <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nToken already approved for the requested amount!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">success</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">alreadyApproved</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nApproval completed successfully!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Transaction Hash:\"</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">transactionHash</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Explorer URL:\"</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">explorerUrl</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword control-flow\">return</span> result<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Error executing approval:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword control-flow\">throw</span> error<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Run if this file is executed directly</span>\n<span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>require<span class=\"token punctuation\">.</span><span class=\"token property-access\">main</span> <span class=\"token operator\">===</span> module<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Example usage: ts-node approval.ts 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913 1000</span>\n    <span class=\"token keyword\">const</span> args <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span><span class=\"token property-access\">argv</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">!==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Usage: ts-node approval.ts &lt;tokenAddress&gt; &lt;amountToApprove&gt;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nExamples:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"  # Approve 1000 USDC\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">  ts-node approval.ts 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913 1000</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        process<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>tokenAddress<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> args<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">executeApproval</span><span class=\"token punctuation\">(</span>tokenAddress<span class=\"token punctuation\">,</span> amount<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> process<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token keyword control-flow\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Error:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            process<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword module\">export</span> <span class=\"token exports\"><span class=\"token punctuation\">{</span> executeApproval <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n\n</code></pre></div>\n<h2 data-content=\"创建兑换指令\" id=\"创建兑换指令\">创建兑换指令<a class=\"index_header-anchor__Xqb+L\" href=\"#创建兑换指令\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// swap.ts</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token punctuation\">{</span> client <span class=\"token punctuation\">}</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'./DexClient'</span><span class=\"token punctuation\">;</span>\n<span class=\"token doc-comment comment\">/**</span>\n<span class=\"token doc-comment comment\"> * Example: Execute a swap from ETH to USDC on Base chain</span>\n<span class=\"token doc-comment comment\"> */</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">executeSwap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>process<span class=\"token punctuation\">.</span><span class=\"token property-access\">env</span><span class=\"token punctuation\">.</span><span class=\"token constant\">EVM_PRIVATE_KEY</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Missing EVM_PRIVATE_KEY in .env file'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// You can change this to any EVM chain</span>\n    <span class=\"token comment\">// For example, for Base, use chainId: '8453'</span>\n    <span class=\"token comment\">// For example, for baseSepolia, use chainId: '84532'</span>\n    <span class=\"token comment\">// You can also use SUI, use chainId: '784'</span>\n    <span class=\"token comment\">// When using another Chain, you need to change the fromTokenAddress and toTokenAddress to the correct addresses for that chain</span>\n\n    <span class=\"token keyword\">const</span> swapResult <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token property-access\">dex</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">executeSwap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">chainId</span><span class=\"token operator\">:</span> <span class=\"token string\">'8453'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Base chain ID</span>\n      <span class=\"token literal-property property\">fromTokenAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">'0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// Native ETH</span>\n      <span class=\"token literal-property property\">toTokenAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// USDC on Base</span>\n      <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span> <span class=\"token operator\">**</span> <span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// .0001 ETH</span>\n      <span class=\"token literal-property property\">slippage</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.5'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 0.5% slippage</span>\n      <span class=\"token literal-property property\">userWalletAddress</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span><span class=\"token property-access\">env</span><span class=\"token punctuation\">.</span><span class=\"token constant\">EVM_WALLET_ADDRESS</span><span class=\"token operator\">!</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Swap executed successfully:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span>swapResult<span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword control-flow\">return</span> swapResult<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>error <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Error executing swap:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// API errors include details in the message</span>\n      <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">'API Error:'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> match <span class=\"token operator\">=</span> error<span class=\"token punctuation\">.</span><span class=\"token property-access\">message</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">API Error: <span class=\"token group punctuation\">(</span><span class=\"token char-set class-name\">.</span><span class=\"token quantifier number\">*</span><span class=\"token group punctuation\">)</span></span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>match<span class=\"token punctuation\">)</span> <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'API Error Details:'</span><span class=\"token punctuation\">,</span> match<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword control-flow\">throw</span> error<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Run if this file is executed directly</span>\n<span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>require<span class=\"token punctuation\">.</span><span class=\"token property-access\">main</span> <span class=\"token operator\">===</span> module<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">executeSwap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> process<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token keyword control-flow\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Error:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      process<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword module\">export</span> <span class=\"token exports\"><span class=\"token punctuation\">{</span> executeSwap <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n\n</code></pre></div>\n<h2 data-content=\"获取报价\" id=\"获取报价\">获取报价<a class=\"index_header-anchor__Xqb+L\" href=\"#获取报价\" style=\"opacity:0\">#</a></h2>\n<div class=\"remark-highlight\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> quote <span class=\"token operator\">=</span> <span class=\"token keyword control-flow\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token property-access\">dex</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getQuote</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">chainId</span><span class=\"token operator\">:</span> <span class=\"token string\">'8453'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Base Chain</span>\n    <span class=\"token literal-property property\">fromTokenAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// USDC</span>\n    <span class=\"token literal-property property\">toTokenAddress</span><span class=\"token operator\">:</span> <span class=\"token string\">'0x4200000000000000000000000000000000000006'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// WETH</span>\n    <span class=\"token literal-property property\">amount</span><span class=\"token operator\">:</span> <span class=\"token string\">'1000000'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 1 USDC (in smallest units)</span>\n    <span class=\"token literal-property property\">slippage</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.5'</span>     <span class=\"token comment\">// 0.5%</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre></div><!--/$--></div>",
  "url": "https://web3.okx.com/zh-hans/build/dev-docs/dex-api/dex-sdk-evm#执行授权指令",
  "navigation": {
    "breadcrumbs": [
      "DEX API",
      "资源",
      "EVM 示例"
    ],
    "sidebar_links": [
      "介绍",
      "EVM 示例",
      "Solana 示例",
      "Sui 示例",
      "Javascript 签名 SDK",
      "Go 签名 SDK"
    ],
    "toc": [
      "执行授权指令",
      "创建兑换指令",
      "获取报价"
    ]
  },
  "word_count": 1081,
  "extract_time": "2025-05-27 01:44:18"
}